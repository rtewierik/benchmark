sudo bin/benchmark \
> --drivers driver-pulsar/pulsar-experiment.yaml \
> --tpc-h-files workloads/tpc-h-q6-1000-100.yaml,workloads/tpc-h-q6-100-10.yaml \
> workloads/tpc-h-base-long.yaml
00:43:24.202 [main] INFO Benchmark - Using default worker file workers.yaml!
00:43:24.208 [main] INFO Benchmark - Reading workers list from workers.yaml
00:43:24.250 [main] INFO Benchmark - Starting benchmark with config: {
  "drivers" : [ "driver-pulsar/pulsar-experiment.yaml" ],
  "workers" : [ "http://10.0.0.149:8080", "http://10.0.0.250:8080", "http://10.0.0.209:8080" ],
  "workersFile" : "/opt/benchmark/workers.yaml",
  "tpcHFiles" : [ "workloads/tpc-h-q6-1000-100.yaml", "workloads/tpc-h-q6-100-10.yaml" ],
  "workloads" : [ "workloads/tpc-h-base-long.yaml" ],
  "output" : null
}
00:43:24.268 [main] INFO Benchmark - Workloads: {
  "tpc-h-base-long" : {
    "name" : "tpc-h",
    "topics" : 0,
    "partitionsPerTopic" : 1,
    "keyDistributor" : "NO_KEY",
    "messageSize" : 0,
    "useRandomizedPayloads" : false,
    "randomBytesRatio" : 0.0,
    "randomizedPayloadPoolSize" : 0,
    "payloadFile" : "",
    "subscriptionsPerTopic" : 1,
    "producersPerTopic" : 1,
    "consumerPerSubscription" : 1,
    "producerRate" : 10000,
    "consumerBacklogSizeGB" : 0,
    "backlogDrainRatio" : 1.0,
    "testDurationMinutes" : 10,
    "warmupDurationMinutes" : 1
  }
}
00:43:24.279 [main] INFO Benchmark - TPC-H arguments: [ {
  "queryId" : "tpc-h-q6-1000-100",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 100
}, {
  "queryId" : "tpc-h-q6-100-10",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/70mb",
  "numberOfChunks" : 100,
  "numberOfWorkers" : 10
} ]
00:43:24.602 [main] INFO CentralWorkerStats - Central worker stats initialized
00:43:24.812 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:43:24.813 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:43:24.816 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:43:26.183 [AsyncHttpClient-8-1] ERROR HttpWorkerClient - Failed to do HTTP post request to http://10.0.0.209:8080/initialize-driver -- code: 500
00:43:26.184 [AsyncHttpClient-6-1] ERROR HttpWorkerClient - Failed to do HTTP post request to http://10.0.0.250:8080/initialize-driver -- code: 500
00:43:26.184 [main] ERROR Benchmark - Failed to run the workload 'tpc-h' for driver 'driver-pulsar/pulsar-experiment.yaml'
java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: java.lang.IllegalArgumentException
	at jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[?:?]
	at jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[?:?]
	at java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499) ~[?:?]
	at java.lang.reflect.Constructor.newInstance(Constructor.java:480) ~[?:?]
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:562) ~[?:?]
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:591) ~[?:?]
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:689) ~[?:?]
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159) ~[?:?]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173) ~[?:?]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233) ~[?:?]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596) ~[?:?]
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:765) ~[?:?]
	at io.openmessaging.benchmark.worker.DistributedWorkersEnsemble.initializeDriver(DistributedWorkersEnsemble.java:102) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:46) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
Caused by: java.util.concurrent.CompletionException: java.lang.IllegalArgumentException
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:649) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.asynchttpclient.netty.NettyResponseFuture.loadContent(NettyResponseFuture.java:222) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.NettyResponseFuture.done(NettyResponseFuture.java:257) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.AsyncHttpClientHandler.finishUpdate(AsyncHttpClientHandler.java:241) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.HttpHandler.handleChunk(HttpHandler.java:113) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.HttpHandler.handleRead(HttpHandler.java:142) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.AsyncHttpClientHandler.channelRead(AsyncHttpClientHandler.java:78) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:719) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:655) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:581) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
Caused by: java.lang.IllegalArgumentException
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:128) ~[com.google.guava-guava-29.0-jre.jar:?]
	at io.openmessaging.benchmark.worker.HttpWorkerClient.lambda$sendPost$0(HttpWorkerClient.java:239) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.asynchttpclient.netty.NettyResponseFuture.loadContent(NettyResponseFuture.java:222) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.NettyResponseFuture.done(NettyResponseFuture.java:257) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.AsyncHttpClientHandler.finishUpdate(AsyncHttpClientHandler.java:241) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.HttpHandler.handleChunk(HttpHandler.java:113) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.HttpHandler.handleRead(HttpHandler.java:142) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at org.asynchttpclient.netty.handler.AsyncHttpClientHandler.channelRead(AsyncHttpClientHandler.java:78) ~[org.asynchttpclient-async-http-client-2.12.3.jar:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:719) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:655) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:581) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-all-4.1.65.Final.jar:4.1.65.Final]
	at java.lang.Thread.run(Thread.java:840) ~[?:?]
00:43:29.585 [main] INFO CentralWorkerStats - Central worker stats initialized
00:43:29.591 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:43:29.591 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:43:29.593 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:43:29.963 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:43:29.977 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:43:30.133 [main] WARN DnsResolverUtil - Cannot get DNS TTL settings from sun.net.InetAddressCachePolicy class
java.lang.IllegalAccessException: class org.apache.pulsar.common.util.netty.DnsResolverUtil cannot access class sun.net.InetAddressCachePolicy (in module java.base) because module java.base does not export sun.net to unnamed module @2a80c531
	at jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392) ~[?:?]
	at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:560) ~[?:?]
	at org.apache.pulsar.common.util.netty.DnsResolverUtil.<clinit>(DnsResolverUtil.java:46) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.createAddressResolver(ConnectionPool.java:159) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.lambda$new$1(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at java.util.Optional.orElseGet(Optional.java:364) ~[?:?]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:95) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:90) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:198) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:154) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:63) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver.initialize(PulsarBenchmarkDriver.java:116) ~[io.openmessaging.benchmark-driver-pulsar-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.LocalWorker.initializeDriver(LocalWorker.java:150) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:48) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
00:43:30.181 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:43:30.317 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:43:30.799 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:43:30.833 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-S2E1-hA
00:43:30.914 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-S2E1-hA: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:43:31.384 [main] INFO WorkloadGenerator - Created 17 topics in 465.425628 ms
00:43:31.778 [main] INFO WorkloadGenerator - Created 17 external consumers in 393.005998 ms
00:43:31.809 [pulsar-client-io-1-3] INFO ConnectionPool - [[id: 0xf6516174, L:/10.0.0.149:53448 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:43:31.834 [pulsar-client-io-1-5] INFO ConnectionPool - [[id: 0xc26fafbd, L:/10.0.0.149:53450 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:43:31.856 [pulsar-client-io-1-8] INFO ConnectionPool - [[id: 0x816ace78, L:/10.0.0.149:53452 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:43:31.864 [pulsar-client-io-1-10] INFO ConnectionPool - [[id: 0x3eca651f, L:/10.0.0.149:35340 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:43:31.867 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-2RJe3wo/test-0000006-wBG8Ppc][sub-006-efqsDyw] Subscribing to topic on cnx [id: 0x3eca651f, L:/10.0.0.149:35340 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:43:31.882 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-2RJe3wo/test-0000006-wBG8Ppc][sub-006-efqsDyw] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:43:31.884 [main] INFO LocalWorker - Created 1 consumers in 105.482543 ms
00:43:31.962 [main] INFO WorkloadGenerator - Created 17 producers in 77.235339 ms
00:43:31.962 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:43:31.985 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
00:43:31.985 [main] INFO WorkloadGenerator - All consumers are ready!
00:43:31.985 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-100-10-2024-05-30-00-43-30 at 1717029811985
00:44:56.278 [pulsar-external-listener-4-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
00:45:02.010 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-100-10-2024-05-30-00-43-30 at 1717029902010
00:45:04.875 [pulsar-client-io-1-10] INFO ClientCnx - [10.0.0.48/10.0.0.48:6650] Broker notification of Closed consumer: 0
00:45:04.875 [pulsar-client-io-1-10] INFO ConnectionHandler - [persistent://benchmark/ns-2RJe3wo/test-0000006-wBG8Ppc] [sub-006-efqsDyw] Closed connection [id: 0x3eca651f, L:/10.0.0.149:35340 - R:10.0.0.48/10.0.0.48:6650] -- Will try again in 0.1 s
00:45:04.978 [pulsar-timer-43-1] INFO ConnectionHandler - [persistent://benchmark/ns-2RJe3wo/test-0000006-wBG8Ppc] [sub-006-efqsDyw] Reconnecting after timeout
00:45:04.982 [pulsar-client-io-1-12] INFO ConnectionPool - [[id: 0x37278781, L:/10.0.0.149:35466 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:45:04.985 [pulsar-client-io-1-12] INFO ConsumerImpl - [persistent://benchmark/ns-2RJe3wo/test-0000006-wBG8Ppc][sub-006-efqsDyw] Subscribing to topic on cnx [id: 0x37278781, L:/10.0.0.149:35466 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:45:05.021 [pulsar-client-io-1-12] INFO ConsumerImpl - [persistent://benchmark/ns-2RJe3wo/test-0000006-wBG8Ppc][sub-006-efqsDyw] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:45:05.423 [pulsar-client-io-1-12] INFO ConsumerImpl - [persistent://benchmark/ns-2RJe3wo/test-0000006-wBG8Ppc] [sub-006-efqsDyw] Closed consumer
00:45:05.424 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:45:05.431 [pulsar-client-io-1-8] INFO ClientCnx - [id: 0x816ace78, L:/10.0.0.149:53452 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:45:05.431 [pulsar-client-io-1-12] INFO ClientCnx - [id: 0x37278781, L:/10.0.0.149:35466 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:45:05.432 [pulsar-client-io-1-5] INFO ClientCnx - [id: 0xc26fafbd, L:/10.0.0.149:53450 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:45:05.432 [pulsar-client-io-1-10] INFO ClientCnx - [id: 0x3eca651f, L:/10.0.0.149:35340 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:45:05.434 [pulsar-client-io-1-3] INFO ClientCnx - [id: 0xf6516174, L:/10.0.0.149:53448 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:45:07.777 [main] INFO PulsarBenchmarkProducer - Topics left over: 0



sudo bin/benchmark \
> --drivers driver-pulsar/pulsar-experiment.yaml \
> --tpc-h-files workloads/tpc-h-q6-1000-100.yaml \
> workloads/tpc-h-base-long.yaml
00:45:17.063 [main] INFO Benchmark - Using default worker file workers.yaml!
00:45:17.069 [main] INFO Benchmark - Reading workers list from workers.yaml
00:45:17.111 [main] INFO Benchmark - Starting benchmark with config: {
  "drivers" : [ "driver-pulsar/pulsar-experiment.yaml" ],
  "workers" : [ "http://10.0.0.149:8080", "http://10.0.0.250:8080", "http://10.0.0.209:8080" ],
  "workersFile" : "/opt/benchmark/workers.yaml",
  "tpcHFiles" : [ "workloads/tpc-h-q6-1000-100.yaml" ],
  "workloads" : [ "workloads/tpc-h-base-long.yaml" ],
  "output" : null
}
00:45:17.128 [main] INFO Benchmark - Workloads: {
  "tpc-h-base-long" : {
    "name" : "tpc-h",
    "topics" : 0,
    "partitionsPerTopic" : 1,
    "keyDistributor" : "NO_KEY",
    "messageSize" : 0,
    "useRandomizedPayloads" : false,
    "randomBytesRatio" : 0.0,
    "randomizedPayloadPoolSize" : 0,
    "payloadFile" : "",
    "subscriptionsPerTopic" : 1,
    "producersPerTopic" : 1,
    "consumerPerSubscription" : 1,
    "producerRate" : 10000,
    "consumerBacklogSizeGB" : 0,
    "backlogDrainRatio" : 1.0,
    "testDurationMinutes" : 10,
    "warmupDurationMinutes" : 1
  }
}
00:45:17.137 [main] INFO Benchmark - TPC-H arguments: [ {
  "queryId" : "tpc-h-q6-1000-100",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 100
} ]
00:45:17.458 [main] INFO CentralWorkerStats - Central worker stats initialized
00:45:17.693 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:45:17.694 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:45:17.697 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:45:18.112 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:45:18.130 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:45:18.290 [main] WARN DnsResolverUtil - Cannot get DNS TTL settings from sun.net.InetAddressCachePolicy class
java.lang.IllegalAccessException: class org.apache.pulsar.common.util.netty.DnsResolverUtil cannot access class sun.net.InetAddressCachePolicy (in module java.base) because module java.base does not export sun.net to unnamed module @2a80c531
	at jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392) ~[?:?]
	at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:560) ~[?:?]
	at org.apache.pulsar.common.util.netty.DnsResolverUtil.<clinit>(DnsResolverUtil.java:46) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.createAddressResolver(ConnectionPool.java:159) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.lambda$new$1(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at java.util.Optional.orElseGet(Optional.java:364) ~[?:?]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:95) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:90) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:198) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:154) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:63) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver.initialize(PulsarBenchmarkDriver.java:116) ~[io.openmessaging.benchmark-driver-pulsar-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.LocalWorker.initializeDriver(LocalWorker.java:150) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:48) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
00:45:18.345 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:45:18.470 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:45:18.957 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:45:18.993 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns--s4Xkag
00:45:19.073 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns--s4Xkag: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:45:19.658 [main] INFO WorkloadGenerator - Created 107 topics in 579.867848 ms
00:45:19.748 [main] INFO WorkloadGenerator - Created 107 external consumers in 85.854813 ms
00:45:19.777 [pulsar-client-io-1-3] INFO ConnectionPool - [[id: 0x83a1bae7, L:/10.0.0.149:53906 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:45:19.801 [pulsar-client-io-1-5] INFO ConnectionPool - [[id: 0x3235ac42, L:/10.0.0.149:53908 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:45:19.828 [pulsar-client-io-1-3] INFO ConsumerImpl - [persistent://benchmark/ns-b-_AbSE/test-0000006-aLOrpwU][sub-006-FqJZPpY] Subscribing to topic on cnx [id: 0x83a1bae7, L:/10.0.0.149:53906 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
00:45:19.843 [pulsar-client-io-1-3] INFO ConsumerImpl - [persistent://benchmark/ns-b-_AbSE/test-0000006-aLOrpwU][sub-006-FqJZPpY] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
00:45:19.844 [main] INFO LocalWorker - Created 1 consumers in 95.961049 ms
00:45:19.904 [main] INFO WorkloadGenerator - Created 107 producers in 59.465722 ms
00:45:19.904 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:45:19.926 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 40, Received: 0, Expected: 0
00:45:19.926 [main] INFO WorkloadGenerator - All consumers are ready!
00:45:19.927 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-1000-100-2024-05-30-00-45-19 at 1717029919927
00:47:14.305 [pulsar-external-listener-4-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
00:47:19.943 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-1000-100-2024-05-30-00-45-19 at 1717030039943
00:47:24.258 [pulsar-client-io-1-3] INFO ClientCnx - [10.0.0.98/10.0.0.98:6650] Broker notification of Closed consumer: 0
00:47:24.258 [pulsar-client-io-1-3] INFO ConnectionHandler - [persistent://benchmark/ns-b-_AbSE/test-0000006-aLOrpwU] [sub-006-FqJZPpY] Closed connection [id: 0x83a1bae7, L:/10.0.0.149:53906 - R:10.0.0.98/10.0.0.98:6650] -- Will try again in 0.1 s
00:47:24.361 [pulsar-timer-43-1] INFO ConnectionHandler - [persistent://benchmark/ns-b-_AbSE/test-0000006-aLOrpwU] [sub-006-FqJZPpY] Reconnecting after timeout
00:47:24.362 [pulsar-client-io-1-8] INFO ConnectionPool - [[id: 0xb12017db, L:/10.0.0.149:54016 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:47:24.367 [pulsar-client-io-1-8] INFO ConsumerImpl - [persistent://benchmark/ns-b-_AbSE/test-0000006-aLOrpwU][sub-006-FqJZPpY] Subscribing to topic on cnx [id: 0x3235ac42, L:/10.0.0.149:53908 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
00:47:24.402 [pulsar-client-io-1-5] INFO ConsumerImpl - [persistent://benchmark/ns-b-_AbSE/test-0000006-aLOrpwU][sub-006-FqJZPpY] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
00:47:24.942 [pulsar-client-io-1-5] INFO ConsumerImpl - [persistent://benchmark/ns-b-_AbSE/test-0000006-aLOrpwU] [sub-006-FqJZPpY] Closed consumer
00:47:24.943 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:47:24.952 [pulsar-client-io-1-3] INFO ClientCnx - [id: 0x83a1bae7, L:/10.0.0.149:53906 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:47:24.953 [pulsar-client-io-1-5] INFO ClientCnx - [id: 0x3235ac42, L:/10.0.0.149:53908 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:47:24.952 [pulsar-client-io-1-8] INFO ClientCnx - [id: 0xb12017db, L:/10.0.0.149:54016 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:47:27.410 [main] INFO PulsarBenchmarkProducer - Topics left over: 0



sudo bin/benchmark \
> --drivers driver-pulsar/pulsar-experiment.yaml \
> --tpc-h-files workloads/tpc-h-q1-1000-100.yaml,workloads/tpc-h-q1-100-10.yaml,workloads/tpc-h-q6-1000-100.yaml,workloads/tpc-h-q6-100-10.yaml \
> workloads/tpc-h-base-long.yaml
00:47:32.070 [main] INFO Benchmark - Using default worker file workers.yaml!
00:47:32.075 [main] INFO Benchmark - Reading workers list from workers.yaml
00:47:32.115 [main] INFO Benchmark - Starting benchmark with config: {
  "drivers" : [ "driver-pulsar/pulsar-experiment.yaml" ],
  "workers" : [ "http://10.0.0.149:8080", "http://10.0.0.250:8080", "http://10.0.0.209:8080" ],
  "workersFile" : "/opt/benchmark/workers.yaml",
  "tpcHFiles" : [ "workloads/tpc-h-q1-1000-100.yaml", "workloads/tpc-h-q1-100-10.yaml", "workloads/tpc-h-q6-1000-100.yaml", "workloads/tpc-h-q6-100-10.yaml" ],
  "workloads" : [ "workloads/tpc-h-base-long.yaml" ],
  "output" : null
}
00:47:32.133 [main] INFO Benchmark - Workloads: {
  "tpc-h-base-long" : {
    "name" : "tpc-h",
    "topics" : 0,
    "partitionsPerTopic" : 1,
    "keyDistributor" : "NO_KEY",
    "messageSize" : 0,
    "useRandomizedPayloads" : false,
    "randomBytesRatio" : 0.0,
    "randomizedPayloadPoolSize" : 0,
    "payloadFile" : "",
    "subscriptionsPerTopic" : 1,
    "producersPerTopic" : 1,
    "consumerPerSubscription" : 1,
    "producerRate" : 10000,
    "consumerBacklogSizeGB" : 0,
    "backlogDrainRatio" : 1.0,
    "testDurationMinutes" : 10,
    "warmupDurationMinutes" : 1
  }
}
00:47:32.143 [main] INFO Benchmark - TPC-H arguments: [ {
  "queryId" : "tpc-h-q1-1000-100",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 100
}, {
  "queryId" : "tpc-h-q1-100-10",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/70mb",
  "numberOfChunks" : 100,
  "numberOfWorkers" : 10
}, {
  "queryId" : "tpc-h-q6-1000-100",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 100
}, {
  "queryId" : "tpc-h-q6-100-10",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/70mb",
  "numberOfChunks" : 100,
  "numberOfWorkers" : 10
} ]
00:47:32.466 [main] INFO CentralWorkerStats - Central worker stats initialized
00:47:32.686 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:47:32.687 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:47:32.690 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:47:33.071 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:47:33.083 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:47:33.226 [main] WARN DnsResolverUtil - Cannot get DNS TTL settings from sun.net.InetAddressCachePolicy class
java.lang.IllegalAccessException: class org.apache.pulsar.common.util.netty.DnsResolverUtil cannot access class sun.net.InetAddressCachePolicy (in module java.base) because module java.base does not export sun.net to unnamed module @2a80c531
	at jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392) ~[?:?]
	at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:560) ~[?:?]
	at org.apache.pulsar.common.util.netty.DnsResolverUtil.<clinit>(DnsResolverUtil.java:46) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.createAddressResolver(ConnectionPool.java:159) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.lambda$new$1(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at java.util.Optional.orElseGet(Optional.java:364) ~[?:?]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:95) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:90) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:198) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:154) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:63) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver.initialize(PulsarBenchmarkDriver.java:116) ~[io.openmessaging.benchmark-driver-pulsar-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.LocalWorker.initializeDriver(LocalWorker.java:150) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:48) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
00:47:33.272 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:47:33.396 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:47:33.826 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:47:33.857 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-A38PCu8
00:47:33.918 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-A38PCu8: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:47:34.498 [main] INFO WorkloadGenerator - Created 107 topics in 576.818454 ms
00:47:34.583 [main] INFO WorkloadGenerator - Created 107 external consumers in 81.137583 ms
00:47:34.612 [pulsar-client-io-1-3] INFO ConnectionPool - [[id: 0xcab890e3, L:/10.0.0.149:54320 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:47:34.639 [pulsar-client-io-1-5] INFO ConnectionPool - [[id: 0xca595fca, L:/10.0.0.149:54322 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:47:34.658 [pulsar-client-io-1-8] INFO ConnectionPool - [[id: 0x508474f0, L:/10.0.0.149:54324 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:47:34.666 [pulsar-client-io-1-10] INFO ConnectionPool - [[id: 0x168a5e6d, L:/10.0.0.149:36212 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:47:34.668 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-l-oWyLk/test-0000006-8QfXTaY][sub-006-SJxCelQ] Subscribing to topic on cnx [id: 0x168a5e6d, L:/10.0.0.149:36212 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:47:34.680 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-l-oWyLk/test-0000006-8QfXTaY][sub-006-SJxCelQ] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:47:34.682 [main] INFO LocalWorker - Created 1 consumers in 98.857191 ms
00:47:34.733 [main] INFO WorkloadGenerator - Created 107 producers in 50.294913 ms
00:47:34.733 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:47:34.743 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 3, Received: 0, Expected: 0
00:47:34.744 [main] INFO WorkloadGenerator - All consumers are ready!
00:47:34.744 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-1000-100-2024-05-30-00-47-33 at 1717030054744
00:49:37.941 [pulsar-external-listener-4-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132732,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25.5,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690.0}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880070,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":25.5,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957.0}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612943,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":25.5,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725.0}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
00:49:44.757 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-1000-100-2024-05-30-00-47-33 at 1717030184757
00:49:49.175 [pulsar-client-io-1-10] INFO ClientCnx - [10.0.0.48/10.0.0.48:6650] Broker notification of Closed consumer: 0
00:49:49.175 [pulsar-client-io-1-10] INFO ConnectionHandler - [persistent://benchmark/ns-l-oWyLk/test-0000006-8QfXTaY] [sub-006-SJxCelQ] Closed connection [id: 0x168a5e6d, L:/10.0.0.149:36212 - R:10.0.0.48/10.0.0.48:6650] -- Will try again in 0.1 s
00:49:49.277 [pulsar-timer-43-1] INFO ConnectionHandler - [persistent://benchmark/ns-l-oWyLk/test-0000006-8QfXTaY] [sub-006-SJxCelQ] Reconnecting after timeout
00:49:49.279 [pulsar-client-io-1-12] INFO ConnectionPool - [[id: 0x43d65748, L:/10.0.0.149:54390 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:49:49.284 [pulsar-client-io-1-14] INFO ConnectionPool - [[id: 0x99952d0d, L:/10.0.0.149:36278 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:49:49.286 [pulsar-client-io-1-14] INFO ConsumerImpl - [persistent://benchmark/ns-l-oWyLk/test-0000006-8QfXTaY][sub-006-SJxCelQ] Subscribing to topic on cnx [id: 0x99952d0d, L:/10.0.0.149:36278 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:49:49.320 [pulsar-client-io-1-14] INFO ConsumerImpl - [persistent://benchmark/ns-l-oWyLk/test-0000006-8QfXTaY][sub-006-SJxCelQ] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:49:49.855 [main] INFO ConsumerImpl - [persistent://benchmark/ns-l-oWyLk/test-0000006-8QfXTaY] [sub-006-SJxCelQ] Closed consumer
00:49:49.856 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:49:49.860 [pulsar-client-io-1-8] INFO ClientCnx - [id: 0x508474f0, L:/10.0.0.149:54324 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:49:49.860 [pulsar-client-io-1-14] INFO ClientCnx - [id: 0x99952d0d, L:/10.0.0.149:36278 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:49:49.861 [pulsar-client-io-1-12] INFO ClientCnx - [id: 0x43d65748, L:/10.0.0.149:54390 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:49:49.862 [pulsar-client-io-1-10] INFO ClientCnx - [id: 0x168a5e6d, L:/10.0.0.149:36212 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:49:49.862 [pulsar-client-io-1-5] INFO ClientCnx - [id: 0xca595fca, L:/10.0.0.149:54322 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:49:49.862 [pulsar-client-io-1-3] INFO ClientCnx - [id: 0xcab890e3, L:/10.0.0.149:54320 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:49:52.398 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
00:49:52.607 [main] INFO CentralWorkerStats - Central worker stats initialized
00:49:52.611 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:49:52.611 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:49:52.612 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:49:52.884 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:49:52.885 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:49:52.886 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:49:52.889 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:49:52.911 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:49:52.922 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-8VwHCsk
00:49:52.947 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-8VwHCsk: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:49:53.186 [main] INFO WorkloadGenerator - Created 17 topics in 238.48966 ms
00:49:53.226 [main] INFO WorkloadGenerator - Created 17 external consumers in 38.984479 ms
00:49:53.227 [pulsar-client-io-51-3] INFO ConnectionPool - [[id: 0xbf5018ec, L:/10.0.0.149:54482 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:49:53.230 [pulsar-client-io-51-5] INFO ConnectionPool - [[id: 0x827f3a1c, L:/10.0.0.149:54484 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:49:53.233 [pulsar-client-io-51-5] INFO ConsumerImpl - [persistent://benchmark/ns-sxPoeVE/test-0000006-WxHPc8Y][sub-006-c3J6eSs] Subscribing to topic on cnx [id: 0xbf5018ec, L:/10.0.0.149:54482 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
00:49:53.236 [pulsar-client-io-51-3] INFO ConsumerImpl - [persistent://benchmark/ns-sxPoeVE/test-0000006-WxHPc8Y][sub-006-c3J6eSs] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
00:49:53.237 [main] INFO LocalWorker - Created 1 consumers in 10.880195 ms
00:49:53.251 [main] INFO WorkloadGenerator - Created 17 producers in 14.057301 ms
00:49:53.251 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:49:53.255 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
00:49:53.255 [main] INFO WorkloadGenerator - All consumers are ready!
00:49:53.255 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-100-10-2024-05-30-00-49-52 at 1717030193255
00:51:01.794 [pulsar-external-listener-53-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.13274,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880073,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":26,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612946,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":26,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
00:51:03.258 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-100-10-2024-05-30-00-49-52 at 1717030263258
00:51:06.252 [pulsar-client-io-51-3] INFO ClientCnx - [10.0.0.98/10.0.0.98:6650] Broker notification of Closed consumer: 0
00:51:06.253 [pulsar-client-io-51-3] INFO ConnectionHandler - [persistent://benchmark/ns-sxPoeVE/test-0000006-WxHPc8Y] [sub-006-c3J6eSs] Closed connection [id: 0xbf5018ec, L:/10.0.0.149:54482 - R:10.0.0.98/10.0.0.98:6650] -- Will try again in 0.1 s
00:51:06.355 [pulsar-timer-92-1] INFO ConnectionHandler - [persistent://benchmark/ns-sxPoeVE/test-0000006-WxHPc8Y] [sub-006-c3J6eSs] Reconnecting after timeout
00:51:06.356 [pulsar-client-io-51-8] INFO ConnectionPool - [[id: 0x0e90b370, L:/10.0.0.149:54522 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:51:06.359 [pulsar-client-io-51-10] INFO ConnectionPool - [[id: 0x1ee8d4da, L:/10.0.0.149:54524 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:51:06.360 [pulsar-client-io-51-10] INFO ConsumerImpl - [persistent://benchmark/ns-sxPoeVE/test-0000006-WxHPc8Y][sub-006-c3J6eSs] Subscribing to topic on cnx [id: 0x1ee8d4da, L:/10.0.0.149:54524 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
00:51:06.403 [pulsar-client-io-51-10] INFO ConsumerImpl - [persistent://benchmark/ns-sxPoeVE/test-0000006-WxHPc8Y][sub-006-c3J6eSs] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
00:51:06.870 [pulsar-client-io-51-10] INFO ConsumerImpl - [persistent://benchmark/ns-sxPoeVE/test-0000006-WxHPc8Y] [sub-006-c3J6eSs] Closed consumer
00:51:06.870 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:51:06.871 [pulsar-client-io-51-5] INFO ClientCnx - [id: 0x827f3a1c, L:/10.0.0.149:54484 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:51:06.871 [pulsar-client-io-51-8] INFO ClientCnx - [id: 0x0e90b370, L:/10.0.0.149:54522 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:51:06.871 [pulsar-client-io-51-10] INFO ClientCnx - [id: 0x1ee8d4da, L:/10.0.0.149:54524 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:51:06.871 [pulsar-client-io-51-3] INFO ClientCnx - [id: 0xbf5018ec, L:/10.0.0.149:54482 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:51:09.336 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
00:51:09.541 [main] INFO CentralWorkerStats - Central worker stats initialized
00:51:09.545 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:51:09.545 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:51:09.546 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:51:09.823 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:51:09.824 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:51:09.826 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:51:09.828 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:51:09.858 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:51:09.867 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-6jZvnPE
00:51:09.892 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-6jZvnPE: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:51:10.462 [main] INFO WorkloadGenerator - Created 107 topics in 569.892311 ms
00:51:10.511 [main] INFO WorkloadGenerator - Created 107 external consumers in 47.287726 ms
00:51:10.513 [pulsar-client-io-100-3] INFO ConnectionPool - [[id: 0x80d7fbbb, L:/10.0.0.149:54828 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:51:10.517 [pulsar-client-io-100-5] INFO ConnectionPool - [[id: 0xd1936da8, L:/10.0.0.149:54830 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:51:10.520 [pulsar-client-io-100-8] INFO ConnectionPool - [[id: 0xd65c14e1, L:/10.0.0.149:54832 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:51:10.521 [pulsar-client-io-100-10] INFO ConnectionPool - [[id: 0x2dc2b297, L:/10.0.0.149:36720 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:51:10.522 [pulsar-client-io-100-10] INFO ConsumerImpl - [persistent://benchmark/ns-BY0NlwM/test-0000006-QpMC9Bo][sub-006-0PD8MAo] Subscribing to topic on cnx [id: 0x2dc2b297, L:/10.0.0.149:36720 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:51:10.525 [pulsar-client-io-100-10] INFO ConsumerImpl - [persistent://benchmark/ns-BY0NlwM/test-0000006-QpMC9Bo][sub-006-0PD8MAo] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:51:10.525 [main] INFO LocalWorker - Created 1 consumers in 13.291357 ms
00:51:10.555 [main] INFO WorkloadGenerator - Created 107 producers in 30.397932 ms
00:51:10.556 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:51:10.560 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
00:51:10.560 [main] INFO WorkloadGenerator - All consumers are ready!
00:51:10.560 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-1000-100-2024-05-30-00-51-09 at 1717030270560
00:52:59.104 [pulsar-external-listener-102-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
00:53:00.563 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-1000-100-2024-05-30-00-51-09 at 1717030380563
00:53:04.542 [pulsar-client-io-100-10] INFO ClientCnx - [10.0.0.48/10.0.0.48:6650] Broker notification of Closed consumer: 0
00:53:04.542 [pulsar-client-io-100-10] INFO ConnectionHandler - [persistent://benchmark/ns-BY0NlwM/test-0000006-QpMC9Bo] [sub-006-0PD8MAo] Closed connection [id: 0x2dc2b297, L:/10.0.0.149:36720 - R:10.0.0.48/10.0.0.48:6650] -- Will try again in 0.1 s
00:53:04.644 [pulsar-timer-141-1] INFO ConnectionHandler - [persistent://benchmark/ns-BY0NlwM/test-0000006-QpMC9Bo] [sub-006-0PD8MAo] Reconnecting after timeout
00:53:04.647 [pulsar-client-io-100-12] INFO ConnectionPool - [[id: 0x47696b57, L:/10.0.0.149:36830 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:53:04.648 [pulsar-client-io-100-12] INFO ConsumerImpl - [persistent://benchmark/ns-BY0NlwM/test-0000006-QpMC9Bo][sub-006-0PD8MAo] Subscribing to topic on cnx [id: 0x47696b57, L:/10.0.0.149:36830 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:53:04.685 [pulsar-client-io-100-12] INFO ConsumerImpl - [persistent://benchmark/ns-BY0NlwM/test-0000006-QpMC9Bo][sub-006-0PD8MAo] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:53:05.340 [pulsar-client-io-100-12] INFO ConsumerImpl - [persistent://benchmark/ns-BY0NlwM/test-0000006-QpMC9Bo] [sub-006-0PD8MAo] Closed consumer
00:53:05.340 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:53:05.341 [pulsar-client-io-100-8] INFO ClientCnx - [id: 0xd65c14e1, L:/10.0.0.149:54832 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:53:05.341 [pulsar-client-io-100-5] INFO ClientCnx - [id: 0xd1936da8, L:/10.0.0.149:54830 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:53:05.341 [pulsar-client-io-100-10] INFO ClientCnx - [id: 0x2dc2b297, L:/10.0.0.149:36720 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:53:05.342 [pulsar-client-io-100-12] INFO ClientCnx - [id: 0x47696b57, L:/10.0.0.149:36830 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:53:05.342 [pulsar-client-io-100-3] INFO ClientCnx - [id: 0x80d7fbbb, L:/10.0.0.149:54828 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:53:07.869 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
00:53:08.074 [main] INFO CentralWorkerStats - Central worker stats initialized
00:53:08.078 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:53:08.078 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:53:08.079 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:53:08.343 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:53:08.344 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:53:08.346 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:53:08.348 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:53:08.366 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:53:08.376 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-_cEbWM4
00:53:08.402 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-_cEbWM4: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:53:08.616 [main] INFO WorkloadGenerator - Created 17 topics in 213.23655 ms
00:53:08.647 [main] INFO WorkloadGenerator - Created 17 external consumers in 30.893579 ms
00:53:08.649 [pulsar-client-io-149-3] INFO ConnectionPool - [[id: 0x06ba011d, L:/10.0.0.149:55030 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:53:08.652 [pulsar-client-io-149-5] INFO ConnectionPool - [[id: 0x61df76f3, L:/10.0.0.149:55032 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:53:08.655 [pulsar-client-io-149-8] INFO ConnectionPool - [[id: 0xa8bf6a85, L:/10.0.0.149:36920 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:53:08.655 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-JEJjyIo/test-0000006-XCuUYwg][sub-006-KRJFhlE] Subscribing to topic on cnx [id: 0xa8bf6a85, L:/10.0.0.149:36920 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:53:08.660 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-JEJjyIo/test-0000006-XCuUYwg][sub-006-KRJFhlE] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:53:08.660 [main] INFO LocalWorker - Created 1 consumers in 12.717643 ms
00:53:08.673 [main] INFO WorkloadGenerator - Created 17 producers in 12.961822 ms
00:53:08.673 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:53:08.677 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
00:53:08.677 [main] INFO WorkloadGenerator - All consumers are ready!
00:53:08.677 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-100-10-2024-05-30-00-53-08 at 1717030388677
00:54:08.274 [pulsar-external-listener-151-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
00:54:08.680 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-100-10-2024-05-30-00-53-08 at 1717030448680
00:54:11.149 [pulsar-client-io-149-8] INFO ClientCnx - [10.0.0.48/10.0.0.48:6650] Broker notification of Closed consumer: 0
00:54:11.150 [pulsar-client-io-149-8] INFO ConnectionHandler - [persistent://benchmark/ns-JEJjyIo/test-0000006-XCuUYwg] [sub-006-KRJFhlE] Closed connection [id: 0xa8bf6a85, L:/10.0.0.149:36920 - R:10.0.0.48/10.0.0.48:6650] -- Will try again in 0.1 s
00:54:11.252 [pulsar-timer-190-1] INFO ConnectionHandler - [persistent://benchmark/ns-JEJjyIo/test-0000006-XCuUYwg] [sub-006-KRJFhlE] Reconnecting after timeout
00:54:11.254 [pulsar-client-io-149-10] INFO ConnectionPool - [[id: 0x88c5d538, L:/10.0.0.149:36958 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
00:54:11.255 [pulsar-client-io-149-10] INFO ConsumerImpl - [persistent://benchmark/ns-JEJjyIo/test-0000006-XCuUYwg][sub-006-KRJFhlE] Subscribing to topic on cnx [id: 0x88c5d538, L:/10.0.0.149:36958 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
00:54:11.290 [pulsar-client-io-149-10] INFO ConsumerImpl - [persistent://benchmark/ns-JEJjyIo/test-0000006-XCuUYwg][sub-006-KRJFhlE] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
00:54:12.289 [pulsar-client-io-149-10] INFO ConsumerImpl - [persistent://benchmark/ns-JEJjyIo/test-0000006-XCuUYwg] [sub-006-KRJFhlE] Closed consumer
00:54:12.289 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:54:12.290 [pulsar-client-io-149-8] INFO ClientCnx - [id: 0xa8bf6a85, L:/10.0.0.149:36920 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:54:12.290 [pulsar-client-io-149-3] INFO ClientCnx - [id: 0x06ba011d, L:/10.0.0.149:55030 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:54:12.290 [pulsar-client-io-149-5] INFO ClientCnx - [id: 0x61df76f3, L:/10.0.0.149:55032 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:54:12.291 [pulsar-client-io-149-10] INFO ClientCnx - [id: 0x88c5d538, L:/10.0.0.149:36958 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
00:54:14.919 [main] INFO PulsarBenchmarkProducer - Topics left over: 0



sudo bin/benchmark \
> --drivers driver-pulsar/pulsar-experiment.yaml \
> --tpc-h-files workloads/tpc-h-q1-1000-300.yaml,workloads/tpc-h-q1-100-30.yaml,workloads/tpc-h-q6-1000-300.yaml,workloads/tpc-h-q6-100-30.yaml \
> workloads/tpc-h-base-long.yaml
00:54:21.435 [main] INFO Benchmark - Using default worker file workers.yaml!
00:54:21.441 [main] INFO Benchmark - Reading workers list from workers.yaml
00:54:21.481 [main] INFO Benchmark - Starting benchmark with config: {
  "drivers" : [ "driver-pulsar/pulsar-experiment.yaml" ],
  "workers" : [ "http://10.0.0.149:8080", "http://10.0.0.250:8080", "http://10.0.0.209:8080" ],
  "workersFile" : "/opt/benchmark/workers.yaml",
  "tpcHFiles" : [ "workloads/tpc-h-q1-1000-300.yaml", "workloads/tpc-h-q1-100-30.yaml", "workloads/tpc-h-q6-1000-300.yaml", "workloads/tpc-h-q6-100-30.yaml" ],
  "workloads" : [ "workloads/tpc-h-base-long.yaml" ],
  "output" : null
}
00:54:21.501 [main] INFO Benchmark - Workloads: {
  "tpc-h-base-long" : {
    "name" : "tpc-h",
    "topics" : 0,
    "partitionsPerTopic" : 1,
    "keyDistributor" : "NO_KEY",
    "messageSize" : 0,
    "useRandomizedPayloads" : false,
    "randomBytesRatio" : 0.0,
    "randomizedPayloadPoolSize" : 0,
    "payloadFile" : "",
    "subscriptionsPerTopic" : 1,
    "producersPerTopic" : 1,
    "consumerPerSubscription" : 1,
    "producerRate" : 10000,
    "consumerBacklogSizeGB" : 0,
    "backlogDrainRatio" : 1.0,
    "testDurationMinutes" : 10,
    "warmupDurationMinutes" : 1
  }
}
00:54:21.511 [main] INFO Benchmark - TPC-H arguments: [ {
  "queryId" : "tpc-h-q1-1000-300",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 300
}, {
  "queryId" : "tpc-h-q1-100-30",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/70mb",
  "numberOfChunks" : 100,
  "numberOfWorkers" : 30
}, {
  "queryId" : "tpc-h-q6-1000-300",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 300
}, {
  "queryId" : "tpc-h-q6-100-30",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/70mb",
  "numberOfChunks" : 100,
  "numberOfWorkers" : 30
} ]
00:54:21.862 [main] INFO CentralWorkerStats - Central worker stats initialized
00:54:22.079 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:54:22.080 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:54:22.084 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:54:22.460 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:54:22.476 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:54:22.642 [main] WARN DnsResolverUtil - Cannot get DNS TTL settings from sun.net.InetAddressCachePolicy class
java.lang.IllegalAccessException: class org.apache.pulsar.common.util.netty.DnsResolverUtil cannot access class sun.net.InetAddressCachePolicy (in module java.base) because module java.base does not export sun.net to unnamed module @2a80c531
	at jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392) ~[?:?]
	at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:560) ~[?:?]
	at org.apache.pulsar.common.util.netty.DnsResolverUtil.<clinit>(DnsResolverUtil.java:46) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.createAddressResolver(ConnectionPool.java:159) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.lambda$new$1(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at java.util.Optional.orElseGet(Optional.java:364) ~[?:?]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:95) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:90) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:198) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:154) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:63) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver.initialize(PulsarBenchmarkDriver.java:116) ~[io.openmessaging.benchmark-driver-pulsar-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.LocalWorker.initializeDriver(LocalWorker.java:150) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:48) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
00:54:22.698 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:54:22.823 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:54:23.242 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:54:23.267 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-AgG91wg
00:54:23.317 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-AgG91wg: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:54:24.044 [main] INFO WorkloadGenerator - Created 307 topics in 722.359816 ms
00:54:24.148 [main] INFO WorkloadGenerator - Created 307 external consumers in 95.683116 ms
00:54:24.178 [pulsar-client-io-1-3] INFO ConnectionPool - [[id: 0x07498fcf, L:/10.0.0.149:55830 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:54:24.203 [pulsar-client-io-1-5] INFO ConnectionPool - [[id: 0x1275f91f, L:/10.0.0.149:55832 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:54:24.229 [pulsar-client-io-1-8] INFO ConnectionPool - [[id: 0x5ebdfaf3, L:/10.0.0.149:55834 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:54:24.237 [pulsar-client-io-1-10] INFO ConnectionPool - [[id: 0x5ab2d690, L:/10.0.0.149:51664 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
00:54:24.240 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-829IjlU/test-0000006-Pe47AkM][sub-006-S9dqJLE] Subscribing to topic on cnx [id: 0x5ab2d690, L:/10.0.0.149:51664 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
00:54:24.252 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-829IjlU/test-0000006-Pe47AkM][sub-006-S9dqJLE] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
00:54:24.253 [main] INFO LocalWorker - Created 1 consumers in 104.193772 ms
00:54:24.329 [main] INFO WorkloadGenerator - Created 307 producers in 75.684677 ms
00:54:24.329 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:54:24.339 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 1, Received: 0, Expected: 0
00:54:24.339 [main] INFO WorkloadGenerator - All consumers are ready!
00:54:24.340 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-1000-300-2024-05-30-00-54-23 at 1717030464339
00:57:07.630 [pulsar-external-listener-4-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132732,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25.5,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690.0}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880070,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":25.5,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957.0}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612943,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":25.5,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725.0}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
00:57:14.353 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-1000-300-2024-05-30-00-54-23 at 1717030634353
00:57:18.960 [pulsar-client-io-1-10] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
00:57:18.960 [pulsar-client-io-1-10] INFO ConnectionHandler - [persistent://benchmark/ns-829IjlU/test-0000006-Pe47AkM] [sub-006-S9dqJLE] Closed connection [id: 0x5ab2d690, L:/10.0.0.149:51664 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
00:57:19.063 [pulsar-timer-43-1] INFO ConnectionHandler - [persistent://benchmark/ns-829IjlU/test-0000006-Pe47AkM] [sub-006-S9dqJLE] Reconnecting after timeout
00:57:19.065 [pulsar-client-io-1-12] INFO ConnectionPool - [[id: 0x45762a51, L:/10.0.0.149:55916 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:57:19.069 [pulsar-client-io-1-14] INFO ConnectionPool - [[id: 0xa4dc741f, L:/10.0.0.149:51746 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
00:57:19.072 [pulsar-client-io-1-14] INFO ConsumerImpl - [persistent://benchmark/ns-829IjlU/test-0000006-Pe47AkM][sub-006-S9dqJLE] Subscribing to topic on cnx [id: 0xa4dc741f, L:/10.0.0.149:51746 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
00:57:19.106 [pulsar-client-io-1-14] INFO ConsumerImpl - [persistent://benchmark/ns-829IjlU/test-0000006-Pe47AkM][sub-006-S9dqJLE] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
00:57:22.360 [main] INFO ConsumerImpl - [persistent://benchmark/ns-829IjlU/test-0000006-Pe47AkM] [sub-006-S9dqJLE] Closed consumer
00:57:22.361 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:57:22.367 [pulsar-client-io-1-3] INFO ClientCnx - [id: 0x07498fcf, L:/10.0.0.149:55830 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:57:22.369 [pulsar-client-io-1-10] INFO ClientCnx - [id: 0x5ab2d690, L:/10.0.0.149:51664 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
00:57:22.369 [pulsar-client-io-1-5] INFO ClientCnx - [id: 0x1275f91f, L:/10.0.0.149:55832 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:57:22.367 [pulsar-client-io-1-8] INFO ClientCnx - [id: 0x5ebdfaf3, L:/10.0.0.149:55834 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:57:22.370 [pulsar-client-io-1-14] INFO ClientCnx - [id: 0xa4dc741f, L:/10.0.0.149:51746 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
00:57:22.371 [pulsar-client-io-1-12] INFO ClientCnx - [id: 0x45762a51, L:/10.0.0.149:55916 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:57:25.144 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
00:57:25.352 [main] INFO CentralWorkerStats - Central worker stats initialized
00:57:25.357 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:57:25.357 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:57:25.358 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:57:25.628 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:57:25.629 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:57:25.631 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:57:25.633 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:57:25.655 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:57:25.666 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-cW1PLEE
00:57:25.692 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-cW1PLEE: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:57:26.051 [main] INFO WorkloadGenerator - Created 37 topics in 358.698972 ms
00:57:26.090 [main] INFO WorkloadGenerator - Created 37 external consumers in 38.525136 ms
00:57:26.092 [pulsar-client-io-51-3] INFO ConnectionPool - [[id: 0x6405d1c7, L:/10.0.0.149:56056 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:57:26.097 [pulsar-client-io-51-5] INFO ConnectionPool - [[id: 0x083867b8, L:/10.0.0.149:56058 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:57:26.100 [pulsar-client-io-51-8] INFO ConnectionPool - [[id: 0x0f7a1692, L:/10.0.0.149:51888 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
00:57:26.101 [pulsar-client-io-51-8] INFO ConsumerImpl - [persistent://benchmark/ns-p-E4H-4/test-0000006-8v3rMpA][sub-006-TJSFX0I] Subscribing to topic on cnx [id: 0x0f7a1692, L:/10.0.0.149:51888 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
00:57:26.106 [pulsar-client-io-51-8] INFO ConsumerImpl - [persistent://benchmark/ns-p-E4H-4/test-0000006-8v3rMpA][sub-006-TJSFX0I] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
00:57:26.106 [main] INFO LocalWorker - Created 1 consumers in 15.497118 ms
00:57:26.122 [main] INFO WorkloadGenerator - Created 37 producers in 15.31089 ms
00:57:26.122 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:57:26.125 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
00:57:26.126 [main] INFO WorkloadGenerator - All consumers are ready!
00:57:26.126 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-100-30-2024-05-30-00-57-25 at 1717030646126
00:58:40.846 [pulsar-external-listener-53-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132740,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880077,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":26,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612940,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":26,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
00:58:46.130 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-100-30-2024-05-30-00-57-25 at 1717030726130
00:58:49.437 [pulsar-client-io-51-8] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
00:58:49.437 [pulsar-client-io-51-8] INFO ConnectionHandler - [persistent://benchmark/ns-p-E4H-4/test-0000006-8v3rMpA] [sub-006-TJSFX0I] Closed connection [id: 0x0f7a1692, L:/10.0.0.149:51888 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
00:58:49.539 [pulsar-timer-92-1] INFO ConnectionHandler - [persistent://benchmark/ns-p-E4H-4/test-0000006-8v3rMpA] [sub-006-TJSFX0I] Reconnecting after timeout
00:58:49.541 [pulsar-client-io-51-10] INFO ConnectionPool - [[id: 0x323c0cb0, L:/10.0.0.149:56100 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:58:49.544 [pulsar-client-io-51-12] INFO ConnectionPool - [[id: 0xa3a73b15, L:/10.0.0.149:51930 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
00:58:49.545 [pulsar-client-io-51-12] INFO ConsumerImpl - [persistent://benchmark/ns-p-E4H-4/test-0000006-8v3rMpA][sub-006-TJSFX0I] Subscribing to topic on cnx [id: 0xa3a73b15, L:/10.0.0.149:51930 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
00:58:49.581 [pulsar-client-io-51-12] INFO ConsumerImpl - [persistent://benchmark/ns-p-E4H-4/test-0000006-8v3rMpA][sub-006-TJSFX0I] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
00:58:50.559 [pulsar-client-io-51-12] INFO ConsumerImpl - [persistent://benchmark/ns-p-E4H-4/test-0000006-8v3rMpA] [sub-006-TJSFX0I] Closed consumer
00:58:50.559 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
00:58:50.561 [pulsar-client-io-51-5] INFO ClientCnx - [id: 0x083867b8, L:/10.0.0.149:56058 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:58:50.561 [pulsar-client-io-51-3] INFO ClientCnx - [id: 0x6405d1c7, L:/10.0.0.149:56056 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:58:50.563 [pulsar-client-io-51-8] INFO ClientCnx - [id: 0x0f7a1692, L:/10.0.0.149:51888 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
00:58:50.564 [pulsar-client-io-51-10] INFO ClientCnx - [id: 0x323c0cb0, L:/10.0.0.149:56100 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
00:58:50.565 [pulsar-client-io-51-12] INFO ClientCnx - [id: 0xa3a73b15, L:/10.0.0.149:51930 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
00:58:53.386 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
00:58:53.591 [main] INFO CentralWorkerStats - Central worker stats initialized
00:58:53.594 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
00:58:53.595 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
00:58:53.595 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
00:58:53.873 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
00:58:53.874 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
00:58:53.876 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
00:58:53.879 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
00:58:53.900 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
00:58:53.911 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-lcvZ8wg
00:58:53.937 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-lcvZ8wg: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
00:58:54.658 [main] INFO WorkloadGenerator - Created 307 topics in 721.208445 ms
00:58:54.726 [main] INFO WorkloadGenerator - Created 307 external consumers in 63.255605 ms
00:58:54.727 [pulsar-client-io-100-3] INFO ConnectionPool - [[id: 0xcdfa695a, L:/10.0.0.149:56852 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:58:54.733 [pulsar-client-io-100-6] INFO ConnectionPool - [[id: 0x75a93907, L:/10.0.0.149:56854 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
00:58:54.735 [pulsar-client-io-100-8] INFO ConnectionPool - [[id: 0x89ce72ac, L:/10.0.0.149:52684 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
00:58:54.735 [pulsar-client-io-100-8] INFO ConsumerImpl - [persistent://benchmark/ns-oUbdJMs/test-0000006-3SuI6n4][sub-006-PJ1bR5w] Subscribing to topic on cnx [id: 0x89ce72ac, L:/10.0.0.149:52684 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
00:58:54.741 [pulsar-client-io-100-8] INFO ConsumerImpl - [persistent://benchmark/ns-oUbdJMs/test-0000006-3SuI6n4][sub-006-PJ1bR5w] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
00:58:54.741 [main] INFO LocalWorker - Created 1 consumers in 14.885898 ms
00:58:54.800 [main] INFO WorkloadGenerator - Created 307 producers in 58.972824 ms
00:58:54.800 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
00:58:54.807 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 1, Received: 0, Expected: 0
00:58:54.807 [main] INFO WorkloadGenerator - All consumers are ready!
00:58:54.808 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-1000-300-2024-05-30-00-58-53 at 1717030734808
01:00:40.050 [pulsar-external-listener-102-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:00:44.811 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-1000-300-2024-05-30-00-58-53 at 1717030844811
01:00:52.492 [pulsar-client-io-100-8] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
01:00:52.492 [pulsar-client-io-100-8] INFO ConnectionHandler - [persistent://benchmark/ns-oUbdJMs/test-0000006-3SuI6n4] [sub-006-PJ1bR5w] Closed connection [id: 0x89ce72ac, L:/10.0.0.149:52684 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
01:00:52.594 [pulsar-timer-141-1] INFO ConnectionHandler - [persistent://benchmark/ns-oUbdJMs/test-0000006-3SuI6n4] [sub-006-PJ1bR5w] Reconnecting after timeout
01:00:52.595 [pulsar-client-io-100-10] INFO ConnectionPool - [[id: 0x71c51824, L:/10.0.0.149:56918 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:00:52.597 [pulsar-client-io-100-10] INFO ConsumerImpl - [persistent://benchmark/ns-oUbdJMs/test-0000006-3SuI6n4][sub-006-PJ1bR5w] Subscribing to topic on cnx [id: 0x89ce72ac, L:/10.0.0.149:52684 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:00:52.631 [pulsar-client-io-100-8] INFO ConsumerImpl - [persistent://benchmark/ns-oUbdJMs/test-0000006-3SuI6n4][sub-006-PJ1bR5w] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:00:53.454 [pulsar-client-io-100-8] INFO ConsumerImpl - [persistent://benchmark/ns-oUbdJMs/test-0000006-3SuI6n4] [sub-006-PJ1bR5w] Closed consumer
01:00:53.454 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:00:53.455 [pulsar-client-io-100-3] INFO ClientCnx - [id: 0xcdfa695a, L:/10.0.0.149:56852 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:00:53.455 [pulsar-client-io-100-6] INFO ClientCnx - [id: 0x75a93907, L:/10.0.0.149:56854 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:00:53.455 [pulsar-client-io-100-10] INFO ClientCnx - [id: 0x71c51824, L:/10.0.0.149:56918 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:00:53.455 [pulsar-client-io-100-8] INFO ClientCnx - [id: 0x89ce72ac, L:/10.0.0.149:52684 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:00:56.344 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:00:56.548 [main] INFO CentralWorkerStats - Central worker stats initialized
01:00:56.553 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:00:56.553 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:00:56.554 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:00:56.813 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:00:56.814 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:00:56.817 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:00:56.819 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:00:56.844 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:00:56.856 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-H8audjQ
01:00:56.882 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-H8audjQ: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:00:57.262 [main] INFO WorkloadGenerator - Created 37 topics in 379.486248 ms
01:00:57.296 [main] INFO WorkloadGenerator - Created 37 external consumers in 33.310049 ms
01:00:57.298 [pulsar-client-io-149-3] INFO ConnectionPool - [[id: 0xf53a4ca1, L:/10.0.0.149:57050 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:00:57.302 [pulsar-client-io-149-5] INFO ConnectionPool - [[id: 0x2280f37d, L:/10.0.0.149:57052 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:00:57.305 [pulsar-client-io-149-8] INFO ConnectionPool - [[id: 0x90350b60, L:/10.0.0.149:52882 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:00:57.306 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-wPCwi8w/test-0000006-GVOHRFI][sub-006-7iRPsAM] Subscribing to topic on cnx [id: 0x90350b60, L:/10.0.0.149:52882 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:00:57.311 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-wPCwi8w/test-0000006-GVOHRFI][sub-006-7iRPsAM] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:00:57.311 [main] INFO LocalWorker - Created 1 consumers in 15.10432 ms
01:00:57.324 [main] INFO WorkloadGenerator - Created 37 producers in 13.016639 ms
01:00:57.324 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:00:57.328 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
01:00:57.328 [main] INFO WorkloadGenerator - All consumers are ready!
01:00:57.328 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-100-30-2024-05-30-01-00-56 at 1717030857328
01:02:21.126 [pulsar-external-listener-151-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:02:27.332 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-100-30-2024-05-30-01-00-56 at 1717030947332
01:02:30.859 [pulsar-client-io-149-8] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
01:02:30.859 [pulsar-client-io-149-8] INFO ConnectionHandler - [persistent://benchmark/ns-wPCwi8w/test-0000006-GVOHRFI] [sub-006-7iRPsAM] Closed connection [id: 0x90350b60, L:/10.0.0.149:52882 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
01:02:30.961 [pulsar-timer-190-1] INFO ConnectionHandler - [persistent://benchmark/ns-wPCwi8w/test-0000006-GVOHRFI] [sub-006-7iRPsAM] Reconnecting after timeout
01:02:30.962 [pulsar-client-io-149-10] INFO ConnectionPool - [[id: 0xbad24e88, L:/10.0.0.149:57102 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:02:30.980 [pulsar-client-io-149-12] INFO ConnectionPool - [[id: 0x2b2ba41c, L:/10.0.0.149:52932 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:02:30.980 [pulsar-client-io-149-12] INFO ConsumerImpl - [persistent://benchmark/ns-wPCwi8w/test-0000006-GVOHRFI][sub-006-7iRPsAM] Subscribing to topic on cnx [id: 0x2b2ba41c, L:/10.0.0.149:52932 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:02:31.016 [pulsar-client-io-149-12] INFO ConsumerImpl - [persistent://benchmark/ns-wPCwi8w/test-0000006-GVOHRFI][sub-006-7iRPsAM] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:02:32.160 [pulsar-client-io-149-12] INFO ConsumerImpl - [persistent://benchmark/ns-wPCwi8w/test-0000006-GVOHRFI] [sub-006-7iRPsAM] Closed consumer
01:02:32.161 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:02:32.161 [pulsar-client-io-149-3] INFO ClientCnx - [id: 0xf53a4ca1, L:/10.0.0.149:57050 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:02:32.161 [pulsar-client-io-149-8] INFO ClientCnx - [id: 0x90350b60, L:/10.0.0.149:52882 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:02:32.161 [pulsar-client-io-149-5] INFO ClientCnx - [id: 0x2280f37d, L:/10.0.0.149:57052 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:02:32.161 [pulsar-client-io-149-10] INFO ClientCnx - [id: 0xbad24e88, L:/10.0.0.149:57102 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:02:32.162 [pulsar-client-io-149-12] INFO ClientCnx - [id: 0x2b2ba41c, L:/10.0.0.149:52932 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:02:35.107 [main] INFO PulsarBenchmarkProducer - Topics left over: 0



sudo bin/benchmark \
> --drivers driver-pulsar/pulsar-experiment.yaml \
> --tpc-h-files workloads/tpc-h-q1-1000-500.yaml,workloads/tpc-h-q1-100-50.yaml,workloads/tpc-h-q6-1000-500.yaml,workloads/tpc-h-q6-100-50.yaml \
> workloads/tpc-h-base-long.yaml
01:02:42.047 [main] INFO Benchmark - Using default worker file workers.yaml!
01:02:42.053 [main] INFO Benchmark - Reading workers list from workers.yaml
01:02:42.098 [main] INFO Benchmark - Starting benchmark with config: {
  "drivers" : [ "driver-pulsar/pulsar-experiment.yaml" ],
  "workers" : [ "http://10.0.0.149:8080", "http://10.0.0.250:8080", "http://10.0.0.209:8080" ],
  "workersFile" : "/opt/benchmark/workers.yaml",
  "tpcHFiles" : [ "workloads/tpc-h-q1-1000-500.yaml", "workloads/tpc-h-q1-100-50.yaml", "workloads/tpc-h-q6-1000-500.yaml", "workloads/tpc-h-q6-100-50.yaml" ],
  "workloads" : [ "workloads/tpc-h-base-long.yaml" ],
  "output" : null
}
01:02:42.111 [main] INFO Benchmark - Workloads: {
  "tpc-h-base-long" : {
    "name" : "tpc-h",
    "topics" : 0,
    "partitionsPerTopic" : 1,
    "keyDistributor" : "NO_KEY",
    "messageSize" : 0,
    "useRandomizedPayloads" : false,
    "randomBytesRatio" : 0.0,
    "randomizedPayloadPoolSize" : 0,
    "payloadFile" : "",
    "subscriptionsPerTopic" : 1,
    "producersPerTopic" : 1,
    "consumerPerSubscription" : 1,
    "producerRate" : 10000,
    "consumerBacklogSizeGB" : 0,
    "backlogDrainRatio" : 1.0,
    "testDurationMinutes" : 10,
    "warmupDurationMinutes" : 1
  }
}
01:02:42.122 [main] INFO Benchmark - TPC-H arguments: [ {
  "queryId" : "tpc-h-q1-1000-500",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 500
}, {
  "queryId" : "tpc-h-q1-100-50",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/70mb",
  "numberOfChunks" : 100,
  "numberOfWorkers" : 50
}, {
  "queryId" : "tpc-h-q6-1000-500",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7mb",
  "numberOfChunks" : 1000,
  "numberOfWorkers" : 500
}, {
  "queryId" : "tpc-h-q6-100-50",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/70mb",
  "numberOfChunks" : 100,
  "numberOfWorkers" : 50
} ]
01:02:42.435 [main] INFO CentralWorkerStats - Central worker stats initialized
01:02:42.648 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:02:42.649 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:02:42.652 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:02:43.026 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:02:43.038 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:02:43.185 [main] WARN DnsResolverUtil - Cannot get DNS TTL settings from sun.net.InetAddressCachePolicy class
java.lang.IllegalAccessException: class org.apache.pulsar.common.util.netty.DnsResolverUtil cannot access class sun.net.InetAddressCachePolicy (in module java.base) because module java.base does not export sun.net to unnamed module @2a80c531
	at jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392) ~[?:?]
	at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:560) ~[?:?]
	at org.apache.pulsar.common.util.netty.DnsResolverUtil.<clinit>(DnsResolverUtil.java:46) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.createAddressResolver(ConnectionPool.java:159) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.lambda$new$1(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at java.util.Optional.orElseGet(Optional.java:364) ~[?:?]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:95) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:90) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:198) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:154) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:63) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver.initialize(PulsarBenchmarkDriver.java:116) ~[io.openmessaging.benchmark-driver-pulsar-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.LocalWorker.initializeDriver(LocalWorker.java:150) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:48) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
01:02:43.233 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:02:43.360 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:02:43.780 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:02:43.812 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-arX1OJ0
01:02:43.868 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-arX1OJ0: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:02:44.599 [main] INFO WorkloadGenerator - Created 507 topics in 726.605075 ms
01:02:44.691 [main] INFO WorkloadGenerator - Created 507 external consumers in 79.015111 ms
01:02:44.724 [pulsar-client-io-1-3] INFO ConnectionPool - [[id: 0x53a6d54e, L:/10.0.0.149:58284 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:02:44.749 [pulsar-client-io-1-5] INFO ConnectionPool - [[id: 0x2cb17332, L:/10.0.0.149:58286 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:02:44.775 [pulsar-client-io-1-8] INFO ConnectionPool - [[id: 0xa07527c9, L:/10.0.0.149:58288 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:02:44.782 [pulsar-client-io-1-10] INFO ConnectionPool - [[id: 0xd01dd964, L:/10.0.0.149:54118 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:02:44.785 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-KIaUd8E/test-0000006-mK7o5MA][sub-006-p7zd12E] Subscribing to topic on cnx [id: 0xd01dd964, L:/10.0.0.149:54118 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:02:44.797 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-KIaUd8E/test-0000006-mK7o5MA][sub-006-p7zd12E] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:02:44.798 [main] INFO LocalWorker - Created 1 consumers in 107.316766 ms
01:02:44.856 [main] INFO WorkloadGenerator - Created 507 producers in 56.976024 ms
01:02:44.856 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:02:44.867 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 11, Received: 0, Expected: 0
01:02:44.868 [main] INFO WorkloadGenerator - All consumers are ready!
01:02:44.868 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-1000-500-2024-05-30-01-02-43 at 1717030964868
01:04:34.903 [pulsar-external-listener-4-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132732,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25.5,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690.0}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880070,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":25.5,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957.0}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612943,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":25.5,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725.0}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
01:04:44.882 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-1000-500-2024-05-30-01-02-43 at 1717031084882
01:04:52.827 [pulsar-client-io-1-10] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
01:04:52.827 [pulsar-client-io-1-10] INFO ConnectionHandler - [persistent://benchmark/ns-KIaUd8E/test-0000006-mK7o5MA] [sub-006-p7zd12E] Closed connection [id: 0xd01dd964, L:/10.0.0.149:54118 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
01:04:52.930 [pulsar-timer-43-1] INFO ConnectionHandler - [persistent://benchmark/ns-KIaUd8E/test-0000006-mK7o5MA] [sub-006-p7zd12E] Reconnecting after timeout
01:04:52.934 [pulsar-client-io-1-12] INFO ConnectionPool - [[id: 0x0a5f08c9, L:/10.0.0.149:54244 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:04:52.937 [pulsar-client-io-1-12] INFO ConsumerImpl - [persistent://benchmark/ns-KIaUd8E/test-0000006-mK7o5MA][sub-006-p7zd12E] Subscribing to topic on cnx [id: 0x0a5f08c9, L:/10.0.0.149:54244 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:04:52.971 [pulsar-client-io-1-12] INFO ConsumerImpl - [persistent://benchmark/ns-KIaUd8E/test-0000006-mK7o5MA][sub-006-p7zd12E] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:04:56.624 [main] INFO ConsumerImpl - [persistent://benchmark/ns-KIaUd8E/test-0000006-mK7o5MA] [sub-006-p7zd12E] Closed consumer
01:04:56.625 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:04:56.631 [pulsar-client-io-1-10] INFO ClientCnx - [id: 0xd01dd964, L:/10.0.0.149:54118 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:04:56.631 [pulsar-client-io-1-3] INFO ClientCnx - [id: 0x53a6d54e, L:/10.0.0.149:58284 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:04:56.631 [pulsar-client-io-1-5] INFO ClientCnx - [id: 0x2cb17332, L:/10.0.0.149:58286 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:04:56.632 [pulsar-client-io-1-8] INFO ClientCnx - [id: 0xa07527c9, L:/10.0.0.149:58288 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:04:56.632 [pulsar-client-io-1-12] INFO ClientCnx - [id: 0x0a5f08c9, L:/10.0.0.149:54244 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:04:59.709 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:04:59.917 [main] INFO CentralWorkerStats - Central worker stats initialized
01:04:59.921 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:04:59.921 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:04:59.922 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:05:00.193 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:05:00.194 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:05:00.196 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:05:00.198 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:05:00.219 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:05:00.231 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-R0mzbXY
01:05:00.257 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-R0mzbXY: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:05:00.707 [main] INFO WorkloadGenerator - Created 57 topics in 449.81064 ms
01:05:00.756 [main] INFO WorkloadGenerator - Created 57 external consumers in 47.823217 ms
01:05:00.758 [pulsar-client-io-51-3] INFO ConnectionPool - [[id: 0xffa9dcb1, L:/10.0.0.149:58608 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:05:00.761 [pulsar-client-io-51-5] INFO ConnectionPool - [[id: 0x023fbc7c, L:/10.0.0.149:58610 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:05:00.763 [pulsar-client-io-51-8] INFO ConnectionPool - [[id: 0x478c55a7, L:/10.0.0.149:58612 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:05:00.765 [pulsar-client-io-51-10] INFO ConnectionPool - [[id: 0xbb3587fa, L:/10.0.0.149:58614 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:05:00.766 [pulsar-client-io-51-10] INFO ConsumerImpl - [persistent://benchmark/ns-aoY5MeQ/test-0000006-oP9BTpg][sub-006-abrM6Fo] Subscribing to topic on cnx [id: 0xbb3587fa, L:/10.0.0.149:58614 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:05:00.771 [pulsar-client-io-51-10] INFO ConsumerImpl - [persistent://benchmark/ns-aoY5MeQ/test-0000006-oP9BTpg][sub-006-abrM6Fo] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:05:00.772 [main] INFO LocalWorker - Created 1 consumers in 15.099983 ms
01:05:00.785 [main] INFO WorkloadGenerator - Created 57 producers in 13.210098 ms
01:05:00.785 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:05:00.791 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
01:05:00.791 [main] INFO WorkloadGenerator - All consumers are ready!
01:05:00.791 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-100-50-2024-05-30-01-05-00 at 1717031100791
01:07:15.981 [pulsar-external-listener-53-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132737,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25.5,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690.0}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880071,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":25.5,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957.0}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612946,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":25.5,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725.0}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
01:07:20.794 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-100-50-2024-05-30-01-05-00 at 1717031240794
01:07:24.432 [pulsar-client-io-51-10] INFO ClientCnx - [10.0.0.98/10.0.0.98:6650] Broker notification of Closed consumer: 0
01:07:24.433 [pulsar-client-io-51-10] INFO ConnectionHandler - [persistent://benchmark/ns-aoY5MeQ/test-0000006-oP9BTpg] [sub-006-abrM6Fo] Closed connection [id: 0xbb3587fa, L:/10.0.0.149:58614 - R:10.0.0.98/10.0.0.98:6650] -- Will try again in 0.1 s
01:07:24.535 [pulsar-timer-92-1] INFO ConnectionHandler - [persistent://benchmark/ns-aoY5MeQ/test-0000006-oP9BTpg] [sub-006-abrM6Fo] Reconnecting after timeout
01:07:24.537 [pulsar-client-io-51-12] INFO ConnectionPool - [[id: 0xb5a98a4a, L:/10.0.0.149:58662 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:07:24.539 [pulsar-client-io-51-12] INFO ConsumerImpl - [persistent://benchmark/ns-aoY5MeQ/test-0000006-oP9BTpg][sub-006-abrM6Fo] Subscribing to topic on cnx [id: 0xb5a98a4a, L:/10.0.0.149:58662 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:07:24.572 [pulsar-client-io-51-12] INFO ConsumerImpl - [persistent://benchmark/ns-aoY5MeQ/test-0000006-oP9BTpg][sub-006-abrM6Fo] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:07:25.768 [pulsar-client-io-51-12] INFO ConsumerImpl - [persistent://benchmark/ns-aoY5MeQ/test-0000006-oP9BTpg] [sub-006-abrM6Fo] Closed consumer
01:07:25.768 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:07:25.769 [pulsar-client-io-51-3] INFO ClientCnx - [id: 0xffa9dcb1, L:/10.0.0.149:58608 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:07:25.769 [pulsar-client-io-51-5] INFO ClientCnx - [id: 0x023fbc7c, L:/10.0.0.149:58610 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:07:25.771 [pulsar-client-io-51-8] INFO ClientCnx - [id: 0x478c55a7, L:/10.0.0.149:58612 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:07:25.771 [pulsar-client-io-51-10] INFO ClientCnx - [id: 0xbb3587fa, L:/10.0.0.149:58614 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:07:25.771 [pulsar-client-io-51-12] INFO ClientCnx - [id: 0xb5a98a4a, L:/10.0.0.149:58662 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:07:28.873 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:07:29.077 [main] INFO CentralWorkerStats - Central worker stats initialized
01:07:29.081 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:07:29.081 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:07:29.082 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:07:29.353 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:07:29.354 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:07:29.355 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:07:29.358 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:07:29.381 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:07:29.391 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-rereeyE
01:07:29.417 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-rereeyE: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:07:30.131 [main] INFO WorkloadGenerator - Created 507 topics in 714.022359 ms
01:07:30.201 [main] INFO WorkloadGenerator - Created 507 external consumers in 65.96171 ms
01:07:30.203 [pulsar-client-io-100-3] INFO ConnectionPool - [[id: 0x4b521f18, L:/10.0.0.149:59834 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:07:30.205 [pulsar-client-io-100-5] INFO ConnectionPool - [[id: 0xea4e31d1, L:/10.0.0.149:59836 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:07:30.208 [pulsar-client-io-100-8] INFO ConnectionPool - [[id: 0x7463f913, L:/10.0.0.149:59838 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:07:30.208 [pulsar-client-io-100-8] INFO ConsumerImpl - [persistent://benchmark/ns-Cic2MXM/test-0000006-LfRJwG0][sub-006-SEavIJI] Subscribing to topic on cnx [id: 0x7463f913, L:/10.0.0.149:59838 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:07:30.212 [pulsar-client-io-100-8] INFO ConsumerImpl - [persistent://benchmark/ns-Cic2MXM/test-0000006-LfRJwG0][sub-006-SEavIJI] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:07:30.212 [main] INFO LocalWorker - Created 1 consumers in 10.957958 ms
01:07:30.266 [main] INFO WorkloadGenerator - Created 507 producers in 53.75919 ms
01:07:30.266 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:07:30.273 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 2, Received: 0, Expected: 0
01:07:30.274 [main] INFO WorkloadGenerator - All consumers are ready!
01:07:30.274 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-1000-500-2024-05-30-01-07-29 at 1717031250274
01:08:40.080 [pulsar-external-listener-102-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:08:40.278 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-1000-500-2024-05-30-01-07-29 at 1717031320277
01:08:49.527 [pulsar-client-io-100-8] INFO ClientCnx - [10.0.0.98/10.0.0.98:6650] Broker notification of Closed consumer: 0
01:08:49.527 [pulsar-client-io-100-8] INFO ConnectionHandler - [persistent://benchmark/ns-Cic2MXM/test-0000006-LfRJwG0] [sub-006-SEavIJI] Closed connection [id: 0x7463f913, L:/10.0.0.149:59838 - R:10.0.0.98/10.0.0.98:6650] -- Will try again in 0.1 s
01:08:49.629 [pulsar-timer-141-1] INFO ConnectionHandler - [persistent://benchmark/ns-Cic2MXM/test-0000006-LfRJwG0] [sub-006-SEavIJI] Reconnecting after timeout
01:08:49.630 [pulsar-client-io-100-10] INFO ConnectionPool - [[id: 0xe7783efb, L:/10.0.0.149:59904 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:08:49.633 [pulsar-client-io-100-12] INFO ConnectionPool - [[id: 0xfff2e41c, L:/10.0.0.149:59906 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:08:49.634 [pulsar-client-io-100-12] INFO ConsumerImpl - [persistent://benchmark/ns-Cic2MXM/test-0000006-LfRJwG0][sub-006-SEavIJI] Subscribing to topic on cnx [id: 0xfff2e41c, L:/10.0.0.149:59906 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:08:49.671 [pulsar-client-io-100-12] INFO ConsumerImpl - [persistent://benchmark/ns-Cic2MXM/test-0000006-LfRJwG0][sub-006-SEavIJI] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:08:51.902 [pulsar-client-io-100-12] INFO ConsumerImpl - [persistent://benchmark/ns-Cic2MXM/test-0000006-LfRJwG0] [sub-006-SEavIJI] Closed consumer
01:08:51.903 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:08:51.903 [pulsar-client-io-100-5] INFO ClientCnx - [id: 0xea4e31d1, L:/10.0.0.149:59836 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:08:51.903 [pulsar-client-io-100-3] INFO ClientCnx - [id: 0x4b521f18, L:/10.0.0.149:59834 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:08:51.904 [pulsar-client-io-100-10] INFO ClientCnx - [id: 0xe7783efb, L:/10.0.0.149:59904 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:08:51.904 [pulsar-client-io-100-8] INFO ClientCnx - [id: 0x7463f913, L:/10.0.0.149:59838 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:08:51.904 [pulsar-client-io-100-12] INFO ClientCnx - [id: 0xfff2e41c, L:/10.0.0.149:59906 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:08:55.074 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:08:55.279 [main] INFO CentralWorkerStats - Central worker stats initialized
01:08:55.283 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:08:55.283 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:08:55.283 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:08:55.548 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:08:55.548 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:08:55.550 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:08:55.552 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:08:55.569 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:08:55.581 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-6sNx7oE
01:08:55.607 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-6sNx7oE: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:08:56.035 [main] INFO WorkloadGenerator - Created 57 topics in 427.724017 ms
01:08:56.066 [main] INFO WorkloadGenerator - Created 57 external consumers in 30.249153 ms
01:08:56.068 [pulsar-client-io-149-3] INFO ConnectionPool - [[id: 0x15d9857b, L:/10.0.0.149:60090 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:08:56.070 [pulsar-client-io-149-5] INFO ConnectionPool - [[id: 0xfc585101, L:/10.0.0.149:60092 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:08:56.072 [pulsar-client-io-149-8] INFO ConnectionPool - [[id: 0x766fe1ad, L:/10.0.0.149:60094 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:08:56.073 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-u_SHqbY/test-0000006-Fv4EW-4][sub-006-tRCzUAU] Subscribing to topic on cnx [id: 0x766fe1ad, L:/10.0.0.149:60094 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:08:56.076 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-u_SHqbY/test-0000006-Fv4EW-4][sub-006-tRCzUAU] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:08:56.076 [main] INFO LocalWorker - Created 1 consumers in 10.208561 ms
01:08:56.090 [main] INFO WorkloadGenerator - Created 57 producers in 13.93077 ms
01:08:56.090 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:08:56.094 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
01:08:56.094 [main] INFO WorkloadGenerator - All consumers are ready!
01:08:56.094 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-100-50-2024-05-30-01-08-55 at 1717031336094
01:10:31.079 [pulsar-external-listener-151-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:10:36.100 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-100-50-2024-05-30-01-08-55 at 1717031436100
01:10:40.303 [pulsar-client-io-149-8] INFO ClientCnx - [10.0.0.98/10.0.0.98:6650] Broker notification of Closed consumer: 0
01:10:40.304 [pulsar-client-io-149-8] INFO ConnectionHandler - [persistent://benchmark/ns-u_SHqbY/test-0000006-Fv4EW-4] [sub-006-tRCzUAU] Closed connection [id: 0x766fe1ad, L:/10.0.0.149:60094 - R:10.0.0.98/10.0.0.98:6650] -- Will try again in 0.1 s
01:10:40.406 [pulsar-timer-190-1] INFO ConnectionHandler - [persistent://benchmark/ns-u_SHqbY/test-0000006-Fv4EW-4] [sub-006-tRCzUAU] Reconnecting after timeout
01:10:40.407 [pulsar-client-io-149-10] INFO ConnectionPool - [[id: 0xfd169886, L:/10.0.0.149:60136 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:10:40.409 [pulsar-client-io-149-12] INFO ConnectionPool - [[id: 0x8fd084b5, L:/10.0.0.149:60138 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:10:40.410 [pulsar-client-io-149-12] INFO ConsumerImpl - [persistent://benchmark/ns-u_SHqbY/test-0000006-Fv4EW-4][sub-006-tRCzUAU] Subscribing to topic on cnx [id: 0x8fd084b5, L:/10.0.0.149:60138 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:10:40.446 [pulsar-client-io-149-12] INFO ConsumerImpl - [persistent://benchmark/ns-u_SHqbY/test-0000006-Fv4EW-4][sub-006-tRCzUAU] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:10:41.813 [pulsar-client-io-149-12] INFO ConsumerImpl - [persistent://benchmark/ns-u_SHqbY/test-0000006-Fv4EW-4] [sub-006-tRCzUAU] Closed consumer
01:10:41.814 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:10:41.815 [pulsar-client-io-149-3] INFO ClientCnx - [id: 0x15d9857b, L:/10.0.0.149:60090 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:10:41.815 [pulsar-client-io-149-10] INFO ClientCnx - [id: 0xfd169886, L:/10.0.0.149:60136 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:10:41.815 [pulsar-client-io-149-12] INFO ClientCnx - [id: 0x8fd084b5, L:/10.0.0.149:60138 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:10:41.815 [pulsar-client-io-149-5] INFO ClientCnx - [id: 0xfc585101, L:/10.0.0.149:60092 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:10:41.815 [pulsar-client-io-149-8] INFO ClientCnx - [id: 0x766fe1ad, L:/10.0.0.149:60094 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:10:45.001 [main] INFO PulsarBenchmarkProducer - Topics left over: 0



sudo bin/benchmark \
> --drivers driver-pulsar/pulsar-experiment.yaml \
> --tpc-h-files workloads/tpc-h-q6-10000-800.yaml \
> workloads/tpc-h-base-long.yaml
01:11:18.902 [main] INFO Benchmark - Using default worker file workers.yaml!
01:11:18.907 [main] INFO Benchmark - Reading workers list from workers.yaml
01:11:18.947 [main] INFO Benchmark - Starting benchmark with config: {
  "drivers" : [ "driver-pulsar/pulsar-experiment.yaml" ],
  "workers" : [ "http://10.0.0.149:8080", "http://10.0.0.250:8080", "http://10.0.0.209:8080" ],
  "workersFile" : "/opt/benchmark/workers.yaml",
  "tpcHFiles" : [ "workloads/tpc-h-q6-10000-800.yaml" ],
  "workloads" : [ "workloads/tpc-h-base-long.yaml" ],
  "output" : null
}
01:11:18.964 [main] INFO Benchmark - Workloads: {
  "tpc-h-base-long" : {
    "name" : "tpc-h",
    "topics" : 0,
    "partitionsPerTopic" : 1,
    "keyDistributor" : "NO_KEY",
    "messageSize" : 0,
    "useRandomizedPayloads" : false,
    "randomBytesRatio" : 0.0,
    "randomizedPayloadPoolSize" : 0,
    "payloadFile" : "",
    "subscriptionsPerTopic" : 1,
    "producersPerTopic" : 1,
    "consumerPerSubscription" : 1,
    "producerRate" : 10000,
    "consumerBacklogSizeGB" : 0,
    "backlogDrainRatio" : 1.0,
    "testDurationMinutes" : 10,
    "warmupDurationMinutes" : 1
  }
}
01:11:18.973 [main] INFO Benchmark - TPC-H arguments: [ {
  "queryId" : "tpc-h-q6-10000-800",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7kb",
  "numberOfChunks" : 10000,
  "numberOfWorkers" : 800
} ]
01:11:19.287 [main] INFO CentralWorkerStats - Central worker stats initialized
01:11:19.496 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:11:19.497 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:11:19.500 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:11:19.875 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:11:19.887 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:11:20.031 [main] WARN DnsResolverUtil - Cannot get DNS TTL settings from sun.net.InetAddressCachePolicy class
java.lang.IllegalAccessException: class org.apache.pulsar.common.util.netty.DnsResolverUtil cannot access class sun.net.InetAddressCachePolicy (in module java.base) because module java.base does not export sun.net to unnamed module @2a80c531
	at jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392) ~[?:?]
	at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:560) ~[?:?]
	at org.apache.pulsar.common.util.netty.DnsResolverUtil.<clinit>(DnsResolverUtil.java:46) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.createAddressResolver(ConnectionPool.java:159) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.lambda$new$1(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at java.util.Optional.orElseGet(Optional.java:364) ~[?:?]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:95) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:90) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:198) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:154) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:63) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver.initialize(PulsarBenchmarkDriver.java:116) ~[io.openmessaging.benchmark-driver-pulsar-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.LocalWorker.initializeDriver(LocalWorker.java:150) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:48) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
01:11:20.077 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:11:20.201 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:11:20.629 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:11:20.652 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-NT5rBA4
01:11:20.703 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-NT5rBA4: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:11:21.435 [main] INFO WorkloadGenerator - Created 807 topics in 729.168946 ms
01:11:21.553 [main] INFO WorkloadGenerator - Created 807 external consumers in 100.774368 ms
01:11:21.582 [pulsar-client-io-1-3] INFO ConnectionPool - [[id: 0xa4516baa, L:/10.0.0.149:33776 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:11:21.609 [pulsar-client-io-1-5] INFO ConnectionPool - [[id: 0x74a94580, L:/10.0.0.149:33778 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:11:21.634 [pulsar-client-io-1-8] INFO ConnectionPool - [[id: 0x3aad6413, L:/10.0.0.149:57840 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:11:21.637 [pulsar-client-io-1-8] INFO ConsumerImpl - [persistent://benchmark/ns-gJpMeYE/test-0000006-smJOBQQ][sub-006-2QVCbV8] Subscribing to topic on cnx [id: 0x3aad6413, L:/10.0.0.149:57840 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:11:21.646 [pulsar-client-io-1-8] INFO ConsumerImpl - [persistent://benchmark/ns-gJpMeYE/test-0000006-smJOBQQ][sub-006-2QVCbV8] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:11:21.648 [main] INFO LocalWorker - Created 1 consumers in 95.234781 ms
01:11:21.727 [main] INFO WorkloadGenerator - Created 807 producers in 78.356008 ms
01:11:21.728 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:11:21.740 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 1, Received: 0, Expected: 0
01:11:21.740 [main] INFO WorkloadGenerator - All consumers are ready!
01:11:21.741 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-10000-800-2024-05-30-01-11-20 at 1717031481741
01:15:50.033 [pulsar-external-listener-4-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:15:51.760 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-10000-800-2024-05-30-01-11-20 at 1717031751759
01:15:59.033 [pulsar-client-io-1-8] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
01:15:59.033 [pulsar-client-io-1-8] INFO ConnectionHandler - [persistent://benchmark/ns-gJpMeYE/test-0000006-smJOBQQ] [sub-006-2QVCbV8] Closed connection [id: 0x3aad6413, L:/10.0.0.149:57840 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
01:15:59.136 [pulsar-timer-43-1] INFO ConnectionHandler - [persistent://benchmark/ns-gJpMeYE/test-0000006-smJOBQQ] [sub-006-2QVCbV8] Reconnecting after timeout
01:15:59.140 [pulsar-client-io-1-10] INFO ConnectionPool - [[id: 0xc36c0740, L:/10.0.0.149:58326 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:15:59.143 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-gJpMeYE/test-0000006-smJOBQQ][sub-006-2QVCbV8] Subscribing to topic on cnx [id: 0xc36c0740, L:/10.0.0.149:58326 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:15:59.176 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-gJpMeYE/test-0000006-smJOBQQ][sub-006-2QVCbV8] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:16:09.874 [main] INFO ConsumerImpl - [persistent://benchmark/ns-gJpMeYE/test-0000006-smJOBQQ] [sub-006-2QVCbV8] Closed consumer
01:16:09.874 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:16:09.879 [pulsar-client-io-1-5] INFO ClientCnx - [id: 0x74a94580, L:/10.0.0.149:33778 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:16:09.880 [pulsar-client-io-1-3] INFO ClientCnx - [id: 0xa4516baa, L:/10.0.0.149:33776 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:16:09.880 [pulsar-client-io-1-8] INFO ClientCnx - [id: 0x3aad6413, L:/10.0.0.149:57840 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:16:09.879 [pulsar-client-io-1-10] INFO ClientCnx - [id: 0xc36c0740, L:/10.0.0.149:58326 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:16:13.275 [main] INFO PulsarBenchmarkProducer - Topics left over: 0



sudo bin/benchmark \
> --drivers driver-pulsar/pulsar-experiment.yaml \
> --tpc-h-files workloads/tpc-h-q1-10000-300.yaml,workloads/tpc-h-q1-10000-500.yaml,workloads/tpc-h-q1-10000-800.yaml,workloads/tpc-h-q6-10000-300.yaml,workloads/tpc-h-q6-10000-500.yaml,workloads/tpc-h-q6-10000-800.yaml \
> workloads/tpc-h-base-long.yaml
01:16:24.163 [main] INFO Benchmark - Using default worker file workers.yaml!
01:16:24.169 [main] INFO Benchmark - Reading workers list from workers.yaml
01:16:24.213 [main] INFO Benchmark - Starting benchmark with config: {
  "drivers" : [ "driver-pulsar/pulsar-experiment.yaml" ],
  "workers" : [ "http://10.0.0.149:8080", "http://10.0.0.250:8080", "http://10.0.0.209:8080" ],
  "workersFile" : "/opt/benchmark/workers.yaml",
  "tpcHFiles" : [ "workloads/tpc-h-q1-10000-300.yaml", "workloads/tpc-h-q1-10000-500.yaml", "workloads/tpc-h-q1-10000-800.yaml", "workloads/tpc-h-q6-10000-300.yaml", "workloads/tpc-h-q6-10000-500.yaml", "workloads/tpc-h-q6-10000-800.yaml" ],
  "workloads" : [ "workloads/tpc-h-base-long.yaml" ],
  "output" : null
}
01:16:24.226 [main] INFO Benchmark - Workloads: {
  "tpc-h-base-long" : {
    "name" : "tpc-h",
    "topics" : 0,
    "partitionsPerTopic" : 1,
    "keyDistributor" : "NO_KEY",
    "messageSize" : 0,
    "useRandomizedPayloads" : false,
    "randomBytesRatio" : 0.0,
    "randomizedPayloadPoolSize" : 0,
    "payloadFile" : "",
    "subscriptionsPerTopic" : 1,
    "producersPerTopic" : 1,
    "consumerPerSubscription" : 1,
    "producerRate" : 10000,
    "consumerBacklogSizeGB" : 0,
    "backlogDrainRatio" : 1.0,
    "testDurationMinutes" : 10,
    "warmupDurationMinutes" : 1
  }
}
01:16:24.238 [main] INFO Benchmark - TPC-H arguments: [ {
  "queryId" : "tpc-h-q1-10000-300",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7kb",
  "numberOfChunks" : 10000,
  "numberOfWorkers" : 300
}, {
  "queryId" : "tpc-h-q1-10000-500",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7kb",
  "numberOfChunks" : 10000,
  "numberOfWorkers" : 500
}, {
  "queryId" : "tpc-h-q1-10000-800",
  "query" : "PricingSummaryReport",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7kb",
  "numberOfChunks" : 10000,
  "numberOfWorkers" : 800
}, {
  "queryId" : "tpc-h-q6-10000-300",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7kb",
  "numberOfChunks" : 10000,
  "numberOfWorkers" : 300
}, {
  "queryId" : "tpc-h-q6-10000-500",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7kb",
  "numberOfChunks" : 10000,
  "numberOfWorkers" : 500
}, {
  "queryId" : "tpc-h-q6-10000-800",
  "query" : "ForecastingRevenueChange",
  "sourceDataS3FolderUri" : "s3://tpc-h-chunks/chunks-by-file-size/7kb",
  "numberOfChunks" : 10000,
  "numberOfWorkers" : 800
} ]
01:16:24.542 [main] INFO CentralWorkerStats - Central worker stats initialized
01:16:24.743 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:16:24.744 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:16:24.746 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:16:25.121 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:16:25.133 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:16:25.278 [main] WARN DnsResolverUtil - Cannot get DNS TTL settings from sun.net.InetAddressCachePolicy class
java.lang.IllegalAccessException: class org.apache.pulsar.common.util.netty.DnsResolverUtil cannot access class sun.net.InetAddressCachePolicy (in module java.base) because module java.base does not export sun.net to unnamed module @2a80c531
	at jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392) ~[?:?]
	at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:560) ~[?:?]
	at org.apache.pulsar.common.util.netty.DnsResolverUtil.<clinit>(DnsResolverUtil.java:46) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.createAddressResolver(ConnectionPool.java:159) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.lambda$new$1(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at java.util.Optional.orElseGet(Optional.java:364) ~[?:?]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:126) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:95) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ConnectionPool.<init>(ConnectionPool.java:90) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:198) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.PulsarClientImpl.<init>(PulsarClientImpl.java:154) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at org.apache.pulsar.client.impl.ClientBuilderImpl.build(ClientBuilderImpl.java:63) ~[org.apache.pulsar-pulsar-client-all-2.11.0.jar:2.11.0]
	at io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver.initialize(PulsarBenchmarkDriver.java:116) ~[io.openmessaging.benchmark-driver-pulsar-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.LocalWorker.initializeDriver(LocalWorker.java:150) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.worker.BenchmarkWorkers.initializeDriver(BenchmarkWorkers.java:48) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.executeBenchmark(Benchmark.java:197) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$0(Benchmark.java:161) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$1(Benchmark.java:159) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]
	at io.openmessaging.benchmark.Benchmark.lambda$benchmark$2(Benchmark.java:157) ~[io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at java.util.TreeMap.forEach(TreeMap.java:1282) [?:?]
	at io.openmessaging.benchmark.Benchmark.benchmark(Benchmark.java:155) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
	at io.openmessaging.benchmark.Benchmark.main(Benchmark.java:96) [io.openmessaging.benchmark-benchmark-framework-0.0.1-SNAPSHOT.jar:?]
01:16:25.324 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:16:25.448 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:16:25.869 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:16:25.892 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-BFy0-I8
01:16:25.943 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-BFy0-I8: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:16:26.652 [main] INFO WorkloadGenerator - Created 307 topics in 706.236962 ms
01:16:26.749 [main] INFO WorkloadGenerator - Created 307 external consumers in 87.270514 ms
01:16:26.778 [pulsar-client-io-1-3] INFO ConnectionPool - [[id: 0x589c04fe, L:/10.0.0.149:35018 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:16:26.803 [pulsar-client-io-1-5] INFO ConnectionPool - [[id: 0xa13d7971, L:/10.0.0.149:35020 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:16:26.822 [pulsar-client-io-1-8] INFO ConnectionPool - [[id: 0x360d92ec, L:/10.0.0.149:35022 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:16:26.829 [pulsar-client-io-1-10] INFO ConnectionPool - [[id: 0xd2f93053, L:/10.0.0.149:45142 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
01:16:26.832 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-K-X3Mqc/test-0000006-_V328Kg][sub-006-MNrASDU] Subscribing to topic on cnx [id: 0xd2f93053, L:/10.0.0.149:45142 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
01:16:26.840 [pulsar-client-io-1-10] INFO ConsumerImpl - [persistent://benchmark/ns-K-X3Mqc/test-0000006-_V328Kg][sub-006-MNrASDU] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
01:16:26.842 [main] INFO LocalWorker - Created 1 consumers in 92.612501 ms
01:16:26.883 [main] INFO WorkloadGenerator - Created 307 producers in 40.741318 ms
01:16:26.883 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:16:26.890 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
01:16:26.890 [main] INFO WorkloadGenerator - All consumers are ready!
01:16:26.890 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-10000-300-2024-05-30-01-16-25 at 1717031786890
01:22:25.502 [pulsar-client-io-1-5] INFO ClientCnx - [id: 0xa13d7971, L:/10.0.0.149:35020 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:22:25.502 [pulsar-client-io-1-3] INFO ClientCnx - [id: 0x589c04fe, L:/10.0.0.149:35018 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:22:25.502 [pulsar-client-io-1-8] INFO ClientCnx - [id: 0x360d92ec, L:/10.0.0.149:35022 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:23:12.226 [pulsar-external-listener-4-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132732,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25.5,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690.0}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880070,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":25.5,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957.0}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612943,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":25.5,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725.0}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
01:23:16.904 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-10000-300-2024-05-30-01-16-25 at 1717032196903
01:23:23.663 [pulsar-client-io-1-10] INFO ClientCnx - [10.0.0.48/10.0.0.48:6650] Broker notification of Closed consumer: 0
01:23:23.663 [pulsar-client-io-1-10] INFO ConnectionHandler - [persistent://benchmark/ns-K-X3Mqc/test-0000006-_V328Kg] [sub-006-MNrASDU] Closed connection [id: 0xd2f93053, L:/10.0.0.149:45142 - R:10.0.0.48/10.0.0.48:6650] -- Will try again in 0.1 s
01:23:23.765 [pulsar-timer-43-1] INFO ConnectionHandler - [persistent://benchmark/ns-K-X3Mqc/test-0000006-_V328Kg] [sub-006-MNrASDU] Reconnecting after timeout
01:23:23.767 [pulsar-client-io-1-12] INFO ConnectionPool - [[id: 0xd8ef1dde, L:/10.0.0.149:35966 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:23:23.771 [pulsar-client-io-1-14] INFO ConnectionPool - [[id: 0x1de488a8, L:/10.0.0.149:46086 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
01:23:23.774 [pulsar-client-io-1-14] INFO ConsumerImpl - [persistent://benchmark/ns-K-X3Mqc/test-0000006-_V328Kg][sub-006-MNrASDU] Subscribing to topic on cnx [id: 0x1de488a8, L:/10.0.0.149:46086 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
01:23:23.809 [pulsar-client-io-1-14] INFO ConsumerImpl - [persistent://benchmark/ns-K-X3Mqc/test-0000006-_V328Kg][sub-006-MNrASDU] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
01:23:25.673 [main] INFO ConsumerImpl - [persistent://benchmark/ns-K-X3Mqc/test-0000006-_V328Kg] [sub-006-MNrASDU] Closed consumer
01:23:25.674 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:23:25.679 [pulsar-client-io-1-10] INFO ClientCnx - [id: 0xd2f93053, L:/10.0.0.149:45142 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
01:23:25.679 [pulsar-client-io-1-14] INFO ClientCnx - [id: 0x1de488a8, L:/10.0.0.149:46086 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
01:23:25.682 [pulsar-client-io-1-12] INFO ClientCnx - [id: 0xd8ef1dde, L:/10.0.0.149:35966 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:23:29.116 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:23:29.325 [main] INFO CentralWorkerStats - Central worker stats initialized
01:23:29.329 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:23:29.329 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:23:29.330 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:23:29.594 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:23:29.594 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:23:29.596 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:23:29.598 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:23:29.618 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:23:29.626 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-kT4rsEs
01:23:29.652 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-kT4rsEs: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:23:30.364 [main] INFO WorkloadGenerator - Created 507 topics in 711.349232 ms
01:23:30.432 [main] INFO WorkloadGenerator - Created 507 external consumers in 62.543435 ms
01:23:30.434 [pulsar-client-io-51-3] INFO ConnectionPool - [[id: 0xf7b44fe1, L:/10.0.0.149:37142 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:23:30.437 [pulsar-client-io-51-5] INFO ConnectionPool - [[id: 0x7512145a, L:/10.0.0.149:37144 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:23:30.439 [pulsar-client-io-51-8] INFO ConnectionPool - [[id: 0x053c9e22, L:/10.0.0.149:37146 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:23:30.441 [pulsar-client-io-51-10] INFO ConnectionPool - [[id: 0x8d2e9a5d, L:/10.0.0.149:47266 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
01:23:30.442 [pulsar-client-io-51-10] INFO ConsumerImpl - [persistent://benchmark/ns-BSgsBzw/test-0000006-BQ1VFOE][sub-006-SVWEY4I] Subscribing to topic on cnx [id: 0x8d2e9a5d, L:/10.0.0.149:47266 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
01:23:30.444 [pulsar-client-io-51-10] INFO ConsumerImpl - [persistent://benchmark/ns-BSgsBzw/test-0000006-BQ1VFOE][sub-006-SVWEY4I] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
01:23:30.445 [main] INFO LocalWorker - Created 1 consumers in 12.219001 ms
01:23:30.490 [main] INFO WorkloadGenerator - Created 507 producers in 45.100062 ms
01:23:30.490 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:23:30.496 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
01:23:30.496 [main] INFO WorkloadGenerator - All consumers are ready!
01:23:30.496 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-10000-500-2024-05-30-01-23-29 at 1717032210496
01:27:58.729 [pulsar-external-listener-53-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132732,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25.5,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690.0}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880070,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":25.5,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957.0}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612943,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":25.5,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725.0}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
01:28:00.500 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-10000-500-2024-05-30-01-23-29 at 1717032480500
01:28:10.001 [pulsar-client-io-51-10] INFO ClientCnx - [10.0.0.48/10.0.0.48:6650] Broker notification of Closed consumer: 0
01:28:10.001 [pulsar-client-io-51-10] INFO ConnectionHandler - [persistent://benchmark/ns-BSgsBzw/test-0000006-BQ1VFOE] [sub-006-SVWEY4I] Closed connection [id: 0x8d2e9a5d, L:/10.0.0.149:47266 - R:10.0.0.48/10.0.0.48:6650] -- Will try again in 0.1 s
01:28:10.103 [pulsar-timer-92-1] INFO ConnectionHandler - [persistent://benchmark/ns-BSgsBzw/test-0000006-BQ1VFOE] [sub-006-SVWEY4I] Reconnecting after timeout
01:28:10.105 [pulsar-client-io-51-12] INFO ConnectionPool - [[id: 0x5a2f3a27, L:/10.0.0.149:37990 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:28:10.108 [pulsar-client-io-51-14] INFO ConnectionPool - [[id: 0x27a4f0e4, L:/10.0.0.149:48110 - R:10.0.0.48/10.0.0.48:6650]] Connected to server
01:28:10.109 [pulsar-client-io-51-14] INFO ConsumerImpl - [persistent://benchmark/ns-BSgsBzw/test-0000006-BQ1VFOE][sub-006-SVWEY4I] Subscribing to topic on cnx [id: 0x27a4f0e4, L:/10.0.0.149:48110 - R:10.0.0.48/10.0.0.48:6650], consumerId 0
01:28:10.144 [pulsar-client-io-51-14] INFO ConsumerImpl - [persistent://benchmark/ns-BSgsBzw/test-0000006-BQ1VFOE][sub-006-SVWEY4I] Subscribed to topic on 10.0.0.48/10.0.0.48:6650 -- consumer: 0
01:28:12.259 [pulsar-client-io-51-14] INFO ConsumerImpl - [persistent://benchmark/ns-BSgsBzw/test-0000006-BQ1VFOE] [sub-006-SVWEY4I] Closed consumer
01:28:12.259 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:28:12.263 [pulsar-client-io-51-3] INFO ClientCnx - [id: 0xf7b44fe1, L:/10.0.0.149:37142 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:28:12.263 [pulsar-client-io-51-5] INFO ClientCnx - [id: 0x7512145a, L:/10.0.0.149:37144 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:28:12.263 [pulsar-client-io-51-12] INFO ClientCnx - [id: 0x5a2f3a27, L:/10.0.0.149:37990 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:28:12.266 [pulsar-client-io-51-14] INFO ClientCnx - [id: 0x27a4f0e4, L:/10.0.0.149:48110 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
01:28:12.268 [pulsar-client-io-51-8] INFO ClientCnx - [id: 0x053c9e22, L:/10.0.0.149:37146 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:28:12.268 [pulsar-client-io-51-10] INFO ClientCnx - [id: 0x8d2e9a5d, L:/10.0.0.149:47266 ! R:10.0.0.48/10.0.0.48:6650] Disconnected
01:28:15.719 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:28:15.923 [main] INFO CentralWorkerStats - Central worker stats initialized
01:28:15.928 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:28:15.928 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:28:15.929 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:28:16.198 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:28:16.199 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:28:16.201 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:28:16.202 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:28:16.230 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:28:16.241 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-O7A3PKE
01:28:16.267 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-O7A3PKE: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:28:16.979 [main] INFO WorkloadGenerator - Created 807 topics in 712.191442 ms
01:28:17.092 [main] INFO WorkloadGenerator - Created 807 external consumers in 106.157169 ms
01:28:17.094 [pulsar-client-io-100-3] INFO ConnectionPool - [[id: 0x0811a809, L:/10.0.0.149:39804 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:28:17.097 [pulsar-client-io-100-5] INFO ConnectionPool - [[id: 0xaf5e1b41, L:/10.0.0.149:39806 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:28:17.100 [pulsar-client-io-100-8] INFO ConnectionPool - [[id: 0x68c99efc, L:/10.0.0.149:39808 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:28:17.102 [pulsar-client-io-100-10] INFO ConnectionPool - [[id: 0xa0476a26, L:/10.0.0.149:35638 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:28:17.103 [pulsar-client-io-100-10] INFO ConsumerImpl - [persistent://benchmark/ns-GO8NHMU/test-0000006-sRpUXso][sub-006-ngAMqP0] Subscribing to topic on cnx [id: 0xa0476a26, L:/10.0.0.149:35638 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:28:17.106 [pulsar-client-io-100-10] INFO ConsumerImpl - [persistent://benchmark/ns-GO8NHMU/test-0000006-sRpUXso][sub-006-ngAMqP0] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:28:17.106 [main] INFO LocalWorker - Created 1 consumers in 14.350685 ms
01:28:17.172 [main] INFO WorkloadGenerator - Created 807 producers in 65.132744 ms
01:28:17.172 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:28:17.180 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 2, Received: 0, Expected: 0
01:28:17.180 [main] INFO WorkloadGenerator - All consumers are ready!
01:28:17.180 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q1-10000-800-2024-05-30-01-28-16 at 1717032497180
01:34:16.350 [pulsar-client-io-100-3] INFO ClientCnx - [id: 0x0811a809, L:/10.0.0.149:39804 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:34:16.350 [pulsar-client-io-100-8] INFO ClientCnx - [id: 0x68c99efc, L:/10.0.0.149:39808 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:34:16.350 [pulsar-client-io-100-5] INFO ClientCnx - [id: 0xaf5e1b41, L:/10.0.0.149:39806 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:34:38.722 [pulsar-external-listener-102-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"lineStatus":"O","returnFlag":"N","discountedPriceSum":692969433134.2497,"chargeSum":720694299770.132732,"orderCount":19077602,"basePriceSum":729448143820.78,"averageQuantity":25.5,"averagePrice":38235.84,"averageDiscount":0.05,"quantitySum":486415690.0}},{"columns":{"lineStatus":"F","returnFlag":"R","discountedPriceSum":484203993195.0628,"chargeSum":503570450844.880070,"orderCount":13324947,"basePriceSum":509684306612.03,"averageQuantity":25.5,"averagePrice":38250.38,"averageDiscount":0.05,"quantitySum":339894957.0}},{"columns":{"lineStatus":"F","returnFlag":"A","discountedPriceSum":483946017285.3019,"chargeSum":503310457149.612943,"orderCount":13322390,"basePriceSum":509419078748.72,"averageQuantity":25.5,"averagePrice":38237.81,"averageDiscount":0.05,"quantitySum":339737725.0}},{"columns":{"lineStatus":"F","returnFlag":"N","discountedPriceSum":12628053899.1349,"chargeSum":13133599534.652978,"orderCount":347260,"basePriceSum":13292554922.64,"averageQuantity":25.5,"averagePrice":38278.39,"averageDiscount":0.05,"quantitySum":8863383.0}}]}
01:34:47.185 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q1-10000-800-2024-05-30-01-28-16 at 1717032887185
01:34:55.323 [pulsar-client-io-100-10] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
01:34:55.323 [pulsar-client-io-100-10] INFO ConnectionHandler - [persistent://benchmark/ns-GO8NHMU/test-0000006-sRpUXso] [sub-006-ngAMqP0] Closed connection [id: 0xa0476a26, L:/10.0.0.149:35638 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
01:34:55.425 [pulsar-timer-141-1] INFO ConnectionHandler - [persistent://benchmark/ns-GO8NHMU/test-0000006-sRpUXso] [sub-006-ngAMqP0] Reconnecting after timeout
01:34:55.427 [pulsar-client-io-100-12] INFO ConnectionPool - [[id: 0x83881175, L:/10.0.0.149:40062 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:34:55.429 [pulsar-client-io-100-14] INFO ConnectionPool - [[id: 0xd77131e9, L:/10.0.0.149:35892 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:34:55.430 [pulsar-client-io-100-14] INFO ConsumerImpl - [persistent://benchmark/ns-GO8NHMU/test-0000006-sRpUXso][sub-006-ngAMqP0] Subscribing to topic on cnx [id: 0xd77131e9, L:/10.0.0.149:35892 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:34:55.466 [pulsar-client-io-100-14] INFO ConsumerImpl - [persistent://benchmark/ns-GO8NHMU/test-0000006-sRpUXso][sub-006-ngAMqP0] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:35:04.038 [pulsar-client-io-100-14] INFO ConsumerImpl - [persistent://benchmark/ns-GO8NHMU/test-0000006-sRpUXso] [sub-006-ngAMqP0] Closed consumer
01:35:04.038 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:35:04.039 [pulsar-client-io-100-12] INFO ClientCnx - [id: 0x83881175, L:/10.0.0.149:40062 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:35:04.039 [pulsar-client-io-100-14] INFO ClientCnx - [id: 0xd77131e9, L:/10.0.0.149:35892 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:35:04.039 [pulsar-client-io-100-10] INFO ClientCnx - [id: 0xa0476a26, L:/10.0.0.149:35638 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:35:07.623 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:35:07.827 [main] INFO CentralWorkerStats - Central worker stats initialized
01:35:07.831 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:35:07.831 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:35:07.832 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:35:08.093 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:35:08.094 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:35:08.095 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:35:08.097 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:35:08.116 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:35:08.126 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-mBtF3qc
01:35:08.152 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-mBtF3qc: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:35:08.861 [main] INFO WorkloadGenerator - Created 307 topics in 708.6823 ms
01:35:08.908 [main] INFO WorkloadGenerator - Created 307 external consumers in 46.240518 ms
01:35:08.910 [pulsar-client-io-149-3] INFO ConnectionPool - [[id: 0xc9984cbd, L:/10.0.0.149:40800 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:35:08.913 [pulsar-client-io-149-6] INFO ConnectionPool - [[id: 0x38a840f0, L:/10.0.0.149:40802 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:35:08.915 [pulsar-client-io-149-8] INFO ConnectionPool - [[id: 0xfdd3477a, L:/10.0.0.149:40804 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:35:08.916 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-Qa5DLyw/test-0000006-t3tBDwk][sub-006-9U-hrp0] Subscribing to topic on cnx [id: 0xfdd3477a, L:/10.0.0.149:40804 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:35:08.921 [pulsar-client-io-149-8] INFO ConsumerImpl - [persistent://benchmark/ns-Qa5DLyw/test-0000006-t3tBDwk][sub-006-9U-hrp0] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:35:08.921 [main] INFO LocalWorker - Created 1 consumers in 12.969756 ms
01:35:08.951 [main] INFO WorkloadGenerator - Created 307 producers in 29.438835 ms
01:35:08.951 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:35:08.956 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
01:35:08.956 [main] INFO WorkloadGenerator - All consumers are ready!
01:35:08.956 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-10000-300-2024-05-30-01-35-08 at 1717032908956
01:39:10.165 [pulsar-external-listener-151-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:39:18.960 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-10000-300-2024-05-30-01-35-08 at 1717033158960
01:39:23.639 [pulsar-client-io-149-8] INFO ClientCnx - [10.0.0.98/10.0.0.98:6650] Broker notification of Closed consumer: 0
01:39:23.639 [pulsar-client-io-149-8] INFO ConnectionHandler - [persistent://benchmark/ns-Qa5DLyw/test-0000006-t3tBDwk] [sub-006-9U-hrp0] Closed connection [id: 0xfdd3477a, L:/10.0.0.149:40804 - R:10.0.0.98/10.0.0.98:6650] -- Will try again in 0.1 s
01:39:23.741 [pulsar-timer-190-1] INFO ConnectionHandler - [persistent://benchmark/ns-Qa5DLyw/test-0000006-t3tBDwk] [sub-006-9U-hrp0] Reconnecting after timeout
01:39:23.743 [pulsar-client-io-149-10] INFO ConnectionPool - [[id: 0x81a36946, L:/10.0.0.149:41022 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:39:23.750 [pulsar-client-io-149-10] INFO ConsumerImpl - [persistent://benchmark/ns-Qa5DLyw/test-0000006-t3tBDwk][sub-006-9U-hrp0] Subscribing to topic on cnx [id: 0x38a840f0, L:/10.0.0.149:40802 - R:10.0.0.98/10.0.0.98:6650], consumerId 0
01:39:23.795 [pulsar-client-io-149-6] INFO ConsumerImpl - [persistent://benchmark/ns-Qa5DLyw/test-0000006-t3tBDwk][sub-006-9U-hrp0] Subscribed to topic on 10.0.0.98/10.0.0.98:6650 -- consumer: 0
01:39:28.448 [pulsar-client-io-149-6] INFO ConsumerImpl - [persistent://benchmark/ns-Qa5DLyw/test-0000006-t3tBDwk] [sub-006-9U-hrp0] Closed consumer
01:39:28.448 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:39:28.449 [pulsar-client-io-149-3] INFO ClientCnx - [id: 0xc9984cbd, L:/10.0.0.149:40800 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:39:28.449 [pulsar-client-io-149-8] INFO ClientCnx - [id: 0xfdd3477a, L:/10.0.0.149:40804 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:39:28.449 [pulsar-client-io-149-6] INFO ClientCnx - [id: 0x38a840f0, L:/10.0.0.149:40802 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:39:28.449 [pulsar-client-io-149-10] INFO ClientCnx - [id: 0x81a36946, L:/10.0.0.149:41022 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:39:32.064 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:39:32.269 [main] INFO CentralWorkerStats - Central worker stats initialized
01:39:32.273 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:39:32.273 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:39:32.273 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:39:32.533 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:39:32.533 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:39:32.536 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:39:32.538 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:39:32.560 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:39:32.571 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-fNzKIDo
01:39:32.597 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-fNzKIDo: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:39:33.307 [main] INFO WorkloadGenerator - Created 507 topics in 710.495294 ms
01:39:33.368 [main] INFO WorkloadGenerator - Created 507 external consumers in 58.964228 ms
01:39:33.369 [pulsar-client-io-198-3] INFO ConnectionPool - [[id: 0x708c77c7, L:/10.0.0.149:42190 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:39:33.372 [pulsar-client-io-198-5] INFO ConnectionPool - [[id: 0x15300277, L:/10.0.0.149:42192 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:39:33.374 [pulsar-client-io-198-8] INFO ConnectionPool - [[id: 0x2cd46c11, L:/10.0.0.149:42194 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:39:33.376 [pulsar-client-io-198-10] INFO ConnectionPool - [[id: 0x866605b2, L:/10.0.0.149:38024 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:39:33.376 [pulsar-client-io-198-10] INFO ConsumerImpl - [persistent://benchmark/ns-b2Z_zB0/test-0000006-BCofBtg][sub-006-D3B30CU] Subscribing to topic on cnx [id: 0x866605b2, L:/10.0.0.149:38024 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:39:33.380 [pulsar-client-io-198-10] INFO ConsumerImpl - [persistent://benchmark/ns-b2Z_zB0/test-0000006-BCofBtg][sub-006-D3B30CU] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:39:33.381 [main] INFO LocalWorker - Created 1 consumers in 12.744288 ms
01:39:33.422 [main] INFO WorkloadGenerator - Created 507 producers in 40.892229 ms
01:39:33.422 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:39:33.430 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 8, Received: 0, Expected: 0
01:39:33.430 [main] INFO WorkloadGenerator - All consumers are ready!
01:39:33.430 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-10000-500-2024-05-30-01-39-32 at 1717033173430
01:41:34.820 [pulsar-external-listener-200-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:41:43.434 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-10000-500-2024-05-30-01-39-32 at 1717033303434
01:41:54.611 [pulsar-client-io-198-10] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
01:41:54.611 [pulsar-client-io-198-10] INFO ConnectionHandler - [persistent://benchmark/ns-b2Z_zB0/test-0000006-BCofBtg] [sub-006-D3B30CU] Closed connection [id: 0x866605b2, L:/10.0.0.149:38024 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
01:41:54.713 [pulsar-timer-239-1] INFO ConnectionHandler - [persistent://benchmark/ns-b2Z_zB0/test-0000006-BCofBtg] [sub-006-D3B30CU] Reconnecting after timeout
01:41:54.714 [pulsar-client-io-198-12] INFO ConnectionPool - [[id: 0x9baa52e7, L:/10.0.0.149:42772 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:41:54.716 [pulsar-client-io-198-14] INFO ConnectionPool - [[id: 0xe675514f, L:/10.0.0.149:38602 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:41:54.717 [pulsar-client-io-198-14] INFO ConsumerImpl - [persistent://benchmark/ns-b2Z_zB0/test-0000006-BCofBtg][sub-006-D3B30CU] Subscribing to topic on cnx [id: 0xe675514f, L:/10.0.0.149:38602 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:41:54.750 [pulsar-client-io-198-14] INFO ConsumerImpl - [persistent://benchmark/ns-b2Z_zB0/test-0000006-BCofBtg][sub-006-D3B30CU] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:41:57.284 [pulsar-client-io-198-14] INFO ConsumerImpl - [persistent://benchmark/ns-b2Z_zB0/test-0000006-BCofBtg] [sub-006-D3B30CU] Closed consumer
01:41:57.284 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:41:57.285 [pulsar-client-io-198-5] INFO ClientCnx - [id: 0x15300277, L:/10.0.0.149:42192 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:41:57.285 [pulsar-client-io-198-3] INFO ClientCnx - [id: 0x708c77c7, L:/10.0.0.149:42190 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:41:57.285 [pulsar-client-io-198-12] INFO ClientCnx - [id: 0x9baa52e7, L:/10.0.0.149:42772 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:41:57.285 [pulsar-client-io-198-10] INFO ClientCnx - [id: 0x866605b2, L:/10.0.0.149:38024 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:41:57.285 [pulsar-client-io-198-8] INFO ClientCnx - [id: 0x2cd46c11, L:/10.0.0.149:42194 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:41:57.286 [pulsar-client-io-198-14] INFO ClientCnx - [id: 0xe675514f, L:/10.0.0.149:38602 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:42:01.063 [main] INFO PulsarBenchmarkProducer - Topics left over: 0
01:42:01.266 [main] INFO CentralWorkerStats - Central worker stats initialized
01:42:01.270 [main] INFO DistributedWorkersEnsemble - Workers list - producers: [http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080]
01:42:01.270 [main] INFO DistributedWorkersEnsemble - Workers list - consumers: http://10.0.0.149:8080,http://10.0.0.250:8080,http://10.0.0.209:8080
01:42:01.270 [main] INFO Benchmark - --------------- WORKLOAD : tpc-h --- DRIVER : Pulsar---------------
01:42:01.533 [main] INFO LocalWorker - Driver: {
  "name" : "Pulsar",
  "driverClass" : "io.openmessaging.benchmark.driver.pulsar.PulsarBenchmarkDriver"
}
01:42:01.533 [main] INFO PulsarBenchmarkProducer - Pulsar driver configuration: {
  "client" : {
    "serviceUrl" : "pulsar://10.0.0.98:6650/",
    "httpUrl" : "http://10.0.0.98:8080/",
    "clientMemoryLimitMB" : 256,
    "ioThreads" : 16,
    "connectionsPerBroker" : 8,
    "maxConcurrentLookupRequests" : 1000,
    "namespacePrefix" : "benchmark/ns",
    "clusterName" : "local",
    "topicType" : "persistent",
    "persistence" : {
      "ensembleSize" : 3,
      "writeQuorum" : 3,
      "ackQuorum" : 2,
      "deduplicationEnabled" : false
    },
    "tlsAllowInsecureConnection" : false,
    "tlsEnableHostnameVerification" : false,
    "tlsTrustCertsFilePath" : null,
    "authentication" : {
      "plugin" : null,
      "data" : null
    }
  },
  "producer" : {
    "batchingEnabled" : true,
    "batchingMaxPublishDelayMs" : 1,
    "batchingMaxBytes" : 131072,
    "blockIfQueueFull" : true,
    "pendingQueueSize" : 0,
    "compressionEnabled" : false
  },
  "consumer" : {
    "receiverQueueSize" : 10000,
    "subscriptionType" : "Failover"
  }
}
01:42:01.535 [main] INFO PulsarBenchmarkProducer - Created Pulsar client for service URL pulsar://10.0.0.98:6650/
01:42:01.536 [main] INFO PulsarBenchmarkProducer - Created Pulsar admin client for HTTP URL http://10.0.0.98:8080/
01:42:01.551 [main] INFO PulsarBenchmarkProducer - Created Pulsar tenant benchmark with allowed cluster local
01:42:01.561 [main] INFO PulsarBenchmarkProducer - Created Pulsar namespace benchmark/ns-3zo7OiE
01:42:01.587 [main] INFO PulsarBenchmarkProducer - Applied persistence configuration for namespace benchmark/local/benchmark/ns-3zo7OiE: {
  "ensembleSize" : 3,
  "writeQuorum" : 3,
  "ackQuorum" : 2,
  "deduplicationEnabled" : false
}
01:42:02.664 [main] INFO WorkloadGenerator - Created 807 topics in 1076.822829 ms
01:42:02.748 [main] INFO WorkloadGenerator - Created 807 external consumers in 82.388324 ms
01:42:02.750 [pulsar-client-io-247-3] INFO ConnectionPool - [[id: 0xd8c8610b, L:/10.0.0.149:44584 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:42:02.757 [pulsar-client-io-247-5] INFO ConnectionPool - [[id: 0x1e6af83b, L:/10.0.0.149:44586 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:42:02.759 [pulsar-client-io-247-8] INFO ConnectionPool - [[id: 0x8350a3ad, L:/10.0.0.149:44588 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:42:02.760 [pulsar-client-io-247-10] INFO ConnectionPool - [[id: 0x786f12ea, L:/10.0.0.149:40418 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:42:02.761 [pulsar-client-io-247-10] INFO ConsumerImpl - [persistent://benchmark/ns-SGN_fcE/test-0000006-o2op-Mw][sub-006-3tHrp8A] Subscribing to topic on cnx [id: 0x786f12ea, L:/10.0.0.149:40418 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:42:02.765 [pulsar-client-io-247-10] INFO ConsumerImpl - [persistent://benchmark/ns-SGN_fcE/test-0000006-o2op-Mw][sub-006-3tHrp8A] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:42:02.766 [main] INFO LocalWorker - Created 1 consumers in 17.421949 ms
01:42:02.831 [main] INFO WorkloadGenerator - Created 807 producers in 64.944628 ms
01:42:02.831 [main] INFO WorkloadGenerator - Waiting for consumers to be ready...
01:42:02.837 [main] INFO WorkloadGenerator - Waiting for topics to be ready -- Sent: 0, Received: 0, Expected: 0
01:42:02.837 [main] INFO WorkloadGenerator - All consumers are ready!
01:42:02.838 [main] INFO WorkloadGenerator - [BenchmarkStart] Starting benchmark Pulsar-tpc-h-tpc-h-q6-10000-800-2024-05-30-01-42-01 at 1717033322838
01:45:56.518 [pulsar-external-listener-249-1] INFO LocalWorker - [RESULT] TPC-H query result: {"rows":[{"columns":{"revenue":1106886908.0572}}]}
01:46:02.841 [main] INFO WorkloadGenerator - [BenchmarkEnd] Ending benchmark Pulsar-tpc-h-tpc-h-q6-10000-800-2024-05-30-01-42-01 at 1717033562841
01:46:06.680 [pulsar-client-io-247-10] INFO ClientCnx - [10.0.0.194/10.0.0.194:6650] Broker notification of Closed consumer: 0
01:46:06.680 [pulsar-client-io-247-10] INFO ConnectionHandler - [persistent://benchmark/ns-SGN_fcE/test-0000006-o2op-Mw] [sub-006-3tHrp8A] Closed connection [id: 0x786f12ea, L:/10.0.0.149:40418 - R:10.0.0.194/10.0.0.194:6650] -- Will try again in 0.1 s
01:46:06.782 [pulsar-timer-288-1] INFO ConnectionHandler - [persistent://benchmark/ns-SGN_fcE/test-0000006-o2op-Mw] [sub-006-3tHrp8A] Reconnecting after timeout
01:46:06.784 [pulsar-client-io-247-12] INFO ConnectionPool - [[id: 0x080ac1f0, L:/10.0.0.149:44842 - R:10.0.0.98/10.0.0.98:6650]] Connected to server
01:46:06.787 [pulsar-client-io-247-14] INFO ConnectionPool - [[id: 0xf6aa7639, L:/10.0.0.149:40672 - R:10.0.0.194/10.0.0.194:6650]] Connected to server
01:46:06.787 [pulsar-client-io-247-14] INFO ConsumerImpl - [persistent://benchmark/ns-SGN_fcE/test-0000006-o2op-Mw][sub-006-3tHrp8A] Subscribing to topic on cnx [id: 0xf6aa7639, L:/10.0.0.149:40672 - R:10.0.0.194/10.0.0.194:6650], consumerId 0
01:46:06.820 [pulsar-client-io-247-14] INFO ConsumerImpl - [persistent://benchmark/ns-SGN_fcE/test-0000006-o2op-Mw][sub-006-3tHrp8A] Subscribed to topic on 10.0.0.194/10.0.0.194:6650 -- consumer: 0
01:46:19.811 [pulsar-client-io-247-14] INFO ConsumerImpl - [persistent://benchmark/ns-SGN_fcE/test-0000006-o2op-Mw] [sub-006-3tHrp8A] Closed consumer
01:46:19.811 [main] INFO PulsarClientImpl - Client closing. URL: pulsar://10.0.0.98:6650/
01:46:19.812 [pulsar-client-io-247-3] INFO ClientCnx - [id: 0xd8c8610b, L:/10.0.0.149:44584 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:46:19.812 [pulsar-client-io-247-5] INFO ClientCnx - [id: 0x1e6af83b, L:/10.0.0.149:44586 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:46:19.812 [pulsar-client-io-247-8] INFO ClientCnx - [id: 0x8350a3ad, L:/10.0.0.149:44588 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:46:19.812 [pulsar-client-io-247-14] INFO ClientCnx - [id: 0xf6aa7639, L:/10.0.0.149:40672 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:46:19.812 [pulsar-client-io-247-10] INFO ClientCnx - [id: 0x786f12ea, L:/10.0.0.149:40418 ! R:10.0.0.194/10.0.0.194:6650] Disconnected
01:46:19.813 [pulsar-client-io-247-12] INFO ClientCnx - [id: 0x080ac1f0, L:/10.0.0.149:44842 ! R:10.0.0.98/10.0.0.98:6650] Disconnected
01:46:23.679 [main] INFO PulsarBenchmarkProducer - Topics left over: 0